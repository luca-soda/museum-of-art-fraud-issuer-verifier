/*! For license information please see did-jwt.js.LICENSE.txt */
var t={99:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});var n=r(117);function i(t,e,r){return void 0===e&&(e=new Uint8Array(2)),void 0===r&&(r=0),e[r+0]=t>>>8,e[r+1]=t>>>0,e}function o(t,e,r){return void 0===e&&(e=new Uint8Array(2)),void 0===r&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e}function s(t,e){return void 0===e&&(e=0),t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}function a(t,e){return void 0===e&&(e=0),(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}function c(t,e){return void 0===e&&(e=0),t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}function h(t,e){return void 0===e&&(e=0),(t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e])>>>0}function u(t,e,r){return void 0===e&&(e=new Uint8Array(4)),void 0===r&&(r=0),e[r+0]=t>>>24,e[r+1]=t>>>16,e[r+2]=t>>>8,e[r+3]=t>>>0,e}function f(t,e,r){return void 0===e&&(e=new Uint8Array(4)),void 0===r&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24,e}function d(t,e,r){return void 0===e&&(e=new Uint8Array(8)),void 0===r&&(r=0),u(t/4294967296>>>0,e,r),u(t>>>0,e,r+4),e}function l(t,e,r){return void 0===e&&(e=new Uint8Array(8)),void 0===r&&(r=0),f(t>>>0,e,r),f(t/4294967296>>>0,e,r+4),e}e.readInt16BE=function(t,e){return void 0===e&&(e=0),(t[e+0]<<8|t[e+1])<<16>>16},e.readUint16BE=function(t,e){return void 0===e&&(e=0),(t[e+0]<<8|t[e+1])>>>0},e.readInt16LE=function(t,e){return void 0===e&&(e=0),(t[e+1]<<8|t[e])<<16>>16},e.readUint16LE=function(t,e){return void 0===e&&(e=0),(t[e+1]<<8|t[e])>>>0},e.writeUint16BE=i,e.writeInt16BE=i,e.writeUint16LE=o,e.writeInt16LE=o,e.readInt32BE=s,e.readUint32BE=a,e.readInt32LE=c,e.readUint32LE=h,e.writeUint32BE=u,e.writeInt32BE=u,e.writeUint32LE=f,e.writeInt32LE=f,e.readInt64BE=function(t,e){void 0===e&&(e=0);var r=s(t,e),n=s(t,e+4);return 4294967296*r+n-4294967296*(n>>31)},e.readUint64BE=function(t,e){return void 0===e&&(e=0),4294967296*a(t,e)+a(t,e+4)},e.readInt64LE=function(t,e){void 0===e&&(e=0);var r=c(t,e);return 4294967296*c(t,e+4)+r-4294967296*(r>>31)},e.readUint64LE=function(t,e){void 0===e&&(e=0);var r=h(t,e);return 4294967296*h(t,e+4)+r},e.writeUint64BE=d,e.writeInt64BE=d,e.writeUint64LE=l,e.writeInt64LE=l,e.readUintBE=function(t,e,r){if(void 0===r&&(r=0),t%8!=0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var n=0,i=1,o=t/8+r-1;o>=r;o--)n+=e[o]*i,i*=256;return n},e.readUintLE=function(t,e,r){if(void 0===r&&(r=0),t%8!=0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var n=0,i=1,o=r;o<r+t/8;o++)n+=e[o]*i,i*=256;return n},e.writeUintBE=function(t,e,r,i){if(void 0===r&&(r=new Uint8Array(t/8)),void 0===i&&(i=0),t%8!=0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!n.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var o=1,s=t/8+i-1;s>=i;s--)r[s]=e/o&255,o*=256;return r},e.writeUintLE=function(t,e,r,i){if(void 0===r&&(r=new Uint8Array(t/8)),void 0===i&&(i=0),t%8!=0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!n.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var o=1,s=i;s<i+t/8;s++)r[s]=e/o&255,o*=256;return r},e.readFloat32BE=function(t,e){return void 0===e&&(e=0),new DataView(t.buffer,t.byteOffset,t.byteLength).getFloat32(e)},e.readFloat32LE=function(t,e){return void 0===e&&(e=0),new DataView(t.buffer,t.byteOffset,t.byteLength).getFloat32(e,!0)},e.readFloat64BE=function(t,e){return void 0===e&&(e=0),new DataView(t.buffer,t.byteOffset,t.byteLength).getFloat64(e)},e.readFloat64LE=function(t,e){return void 0===e&&(e=0),new DataView(t.buffer,t.byteOffset,t.byteLength).getFloat64(e,!0)},e.writeFloat32BE=function(t,e,r){return void 0===e&&(e=new Uint8Array(4)),void 0===r&&(r=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setFloat32(r,t),e},e.writeFloat32LE=function(t,e,r){return void 0===e&&(e=new Uint8Array(4)),void 0===r&&(r=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setFloat32(r,t,!0),e},e.writeFloat64BE=function(t,e,r){return void 0===e&&(e=new Uint8Array(8)),void 0===r&&(r=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setFloat64(r,t),e},e.writeFloat64LE=function(t,e,r){return void 0===e&&(e=new Uint8Array(8)),void 0===r&&(r=0),new DataView(e.buffer,e.byteOffset,e.byteLength).setFloat64(r,t,!0),e}},439:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});var n=r(99),i=r(309);function o(t,e,r){for(var i=1634760805,o=857760878,s=2036477234,a=1797285236,c=r[3]<<24|r[2]<<16|r[1]<<8|r[0],h=r[7]<<24|r[6]<<16|r[5]<<8|r[4],u=r[11]<<24|r[10]<<16|r[9]<<8|r[8],f=r[15]<<24|r[14]<<16|r[13]<<8|r[12],d=r[19]<<24|r[18]<<16|r[17]<<8|r[16],l=r[23]<<24|r[22]<<16|r[21]<<8|r[20],p=r[27]<<24|r[26]<<16|r[25]<<8|r[24],y=r[31]<<24|r[30]<<16|r[29]<<8|r[28],w=e[3]<<24|e[2]<<16|e[1]<<8|e[0],g=e[7]<<24|e[6]<<16|e[5]<<8|e[4],b=e[11]<<24|e[10]<<16|e[9]<<8|e[8],m=e[15]<<24|e[14]<<16|e[13]<<8|e[12],v=i,E=o,x=s,A=a,_=c,B=h,I=u,S=f,U=d,P=l,C=p,L=y,D=w,k=g,O=b,T=m,N=0;N<20;N+=2)_=(_^=U=U+(D=(D^=v=v+_|0)>>>16|D<<16)|0)>>>20|_<<12,B=(B^=P=P+(k=(k^=E=E+B|0)>>>16|k<<16)|0)>>>20|B<<12,I=(I^=C=C+(O=(O^=x=x+I|0)>>>16|O<<16)|0)>>>20|I<<12,S=(S^=L=L+(T=(T^=A=A+S|0)>>>16|T<<16)|0)>>>20|S<<12,I=(I^=C=C+(O=(O^=x=x+I|0)>>>24|O<<8)|0)>>>25|I<<7,S=(S^=L=L+(T=(T^=A=A+S|0)>>>24|T<<8)|0)>>>25|S<<7,B=(B^=P=P+(k=(k^=E=E+B|0)>>>24|k<<8)|0)>>>25|B<<7,_=(_^=U=U+(D=(D^=v=v+_|0)>>>24|D<<8)|0)>>>25|_<<7,B=(B^=C=C+(T=(T^=v=v+B|0)>>>16|T<<16)|0)>>>20|B<<12,I=(I^=L=L+(D=(D^=E=E+I|0)>>>16|D<<16)|0)>>>20|I<<12,S=(S^=U=U+(k=(k^=x=x+S|0)>>>16|k<<16)|0)>>>20|S<<12,_=(_^=P=P+(O=(O^=A=A+_|0)>>>16|O<<16)|0)>>>20|_<<12,S=(S^=U=U+(k=(k^=x=x+S|0)>>>24|k<<8)|0)>>>25|S<<7,_=(_^=P=P+(O=(O^=A=A+_|0)>>>24|O<<8)|0)>>>25|_<<7,I=(I^=L=L+(D=(D^=E=E+I|0)>>>24|D<<8)|0)>>>25|I<<7,B=(B^=C=C+(T=(T^=v=v+B|0)>>>24|T<<8)|0)>>>25|B<<7;n.writeUint32LE(v+i|0,t,0),n.writeUint32LE(E+o|0,t,4),n.writeUint32LE(x+s|0,t,8),n.writeUint32LE(A+a|0,t,12),n.writeUint32LE(_+c|0,t,16),n.writeUint32LE(B+h|0,t,20),n.writeUint32LE(I+u|0,t,24),n.writeUint32LE(S+f|0,t,28),n.writeUint32LE(U+d|0,t,32),n.writeUint32LE(P+l|0,t,36),n.writeUint32LE(C+p|0,t,40),n.writeUint32LE(L+y|0,t,44),n.writeUint32LE(D+w|0,t,48),n.writeUint32LE(k+g|0,t,52),n.writeUint32LE(O+b|0,t,56),n.writeUint32LE(T+m|0,t,60)}function s(t,e,r,n,s){if(void 0===s&&(s=0),32!==t.length)throw new Error("ChaCha: key size must be 32 bytes");if(n.length<r.length)throw new Error("ChaCha: destination is shorter than source");var c,h;if(0===s){if(8!==e.length&&12!==e.length)throw new Error("ChaCha nonce must be 8 or 12 bytes");h=(c=new Uint8Array(16)).length-e.length,c.set(e,h)}else{if(16!==e.length)throw new Error("ChaCha nonce with counter must be 16 bytes");c=e,h=s}for(var u=new Uint8Array(64),f=0;f<r.length;f+=64){o(u,c,t);for(var d=f;d<f+64&&d<r.length;d++)n[d]=r[d]^u[d-f];a(c,0,h)}return i.wipe(u),0===s&&i.wipe(c),n}function a(t,e,r){for(var n=1;r--;)n=n+(255&t[e])|0,t[e]=255&n,n>>>=8,e++;if(n>0)throw new Error("ChaCha: counter overflow")}e.streamXOR=s,e.stream=function(t,e,r,n){return void 0===n&&(n=0),i.wipe(r),s(t,e,r,r,n)}},501:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});var n=r(439),i=r(27),o=r(309),s=r(99),a=r(153);e.KEY_LENGTH=32,e.NONCE_LENGTH=12,e.TAG_LENGTH=16;var c=new Uint8Array(16),h=function(){function t(t){if(this.nonceLength=e.NONCE_LENGTH,this.tagLength=e.TAG_LENGTH,t.length!==e.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(t)}return t.prototype.seal=function(t,e,r,i){if(t.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var s=new Uint8Array(16);s.set(t,s.length-t.length);var a=new Uint8Array(32);n.stream(this._key,s,a,4);var c,h=e.length+this.tagLength;if(i){if(i.length!==h)throw new Error("ChaCha20Poly1305: incorrect destination length");c=i}else c=new Uint8Array(h);return n.streamXOR(this._key,s,e,c,4),this._authenticate(c.subarray(c.length-this.tagLength,c.length),a,c.subarray(0,c.length-this.tagLength),r),o.wipe(s),c},t.prototype.open=function(t,e,r,i){if(t.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(e.length<this.tagLength)return null;var s=new Uint8Array(16);s.set(t,s.length-t.length);var c=new Uint8Array(32);n.stream(this._key,s,c,4);var h=new Uint8Array(this.tagLength);if(this._authenticate(h,c,e.subarray(0,e.length-this.tagLength),r),!a.equal(h,e.subarray(e.length-this.tagLength,e.length)))return null;var u,f=e.length-this.tagLength;if(i){if(i.length!==f)throw new Error("ChaCha20Poly1305: incorrect destination length");u=i}else u=new Uint8Array(f);return n.streamXOR(this._key,s,e.subarray(0,e.length-this.tagLength),u,4),o.wipe(s),u},t.prototype.clean=function(){return o.wipe(this._key),this},t.prototype._authenticate=function(t,e,r,n){var a=new i.Poly1305(e);n&&(a.update(n),n.length%16>0&&a.update(c.subarray(n.length%16))),a.update(r),r.length%16>0&&a.update(c.subarray(r.length%16));var h=new Uint8Array(8);n&&s.writeUint64LE(n.length,h),a.update(h),s.writeUint64LE(r.length,h),a.update(h);for(var u=a.digest(),f=0;f<u.length;f++)t[f]=u[f];a.clean(),o.wipe(u),o.wipe(h)},t}();e.ChaCha20Poly1305=h},153:(t,e)=>{function r(t,e){if(t.length!==e.length)return 0;for(var r=0,n=0;n<t.length;n++)r|=t[n]^e[n];return 1&r-1>>>8}Object.defineProperty(e,"__esModule",{value:!0}),e.select=function(t,e,r){return~(t-1)&e|t-1&r},e.lessOrEqual=function(t,e){return(0|t)-(0|e)-1>>>31&1},e.compare=r,e.equal=function(t,e){return 0!==t.length&&0!==e.length&&0!==r(t,e)}},117:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.mul=Math.imul||function(t,e){var r=65535&t,n=65535&e;return r*n+((t>>>16&65535)*n+r*(e>>>16&65535)<<16>>>0)|0},e.add=function(t,e){return t+e|0},e.sub=function(t,e){return t-e|0},e.rotl=function(t,e){return t<<e|t>>>32-e},e.rotr=function(t,e){return t<<32-e|t>>>e},e.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},e.MAX_SAFE_INTEGER=9007199254740991,e.isSafeInteger=function(t){return e.isInteger(t)&&t>=-e.MAX_SAFE_INTEGER&&t<=e.MAX_SAFE_INTEGER}},27:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});var n=r(153),i=r(309);e.DIGEST_LENGTH=16;var o=function(){function t(t){this.digestLength=e.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var r=t[0]|t[1]<<8;this._r[0]=8191&r;var n=t[2]|t[3]<<8;this._r[1]=8191&(r>>>13|n<<3);var i=t[4]|t[5]<<8;this._r[2]=7939&(n>>>10|i<<6);var o=t[6]|t[7]<<8;this._r[3]=8191&(i>>>7|o<<9);var s=t[8]|t[9]<<8;this._r[4]=255&(o>>>4|s<<12),this._r[5]=s>>>1&8190;var a=t[10]|t[11]<<8;this._r[6]=8191&(s>>>14|a<<2);var c=t[12]|t[13]<<8;this._r[7]=8065&(a>>>11|c<<5);var h=t[14]|t[15]<<8;this._r[8]=8191&(c>>>8|h<<8),this._r[9]=h>>>5&127,this._pad[0]=t[16]|t[17]<<8,this._pad[1]=t[18]|t[19]<<8,this._pad[2]=t[20]|t[21]<<8,this._pad[3]=t[22]|t[23]<<8,this._pad[4]=t[24]|t[25]<<8,this._pad[5]=t[26]|t[27]<<8,this._pad[6]=t[28]|t[29]<<8,this._pad[7]=t[30]|t[31]<<8}return t.prototype._blocks=function(t,e,r){for(var n=this._fin?0:2048,i=this._h[0],o=this._h[1],s=this._h[2],a=this._h[3],c=this._h[4],h=this._h[5],u=this._h[6],f=this._h[7],d=this._h[8],l=this._h[9],p=this._r[0],y=this._r[1],w=this._r[2],g=this._r[3],b=this._r[4],m=this._r[5],v=this._r[6],E=this._r[7],x=this._r[8],A=this._r[9];r>=16;){var _=t[e+0]|t[e+1]<<8;i+=8191&_;var B=t[e+2]|t[e+3]<<8;o+=8191&(_>>>13|B<<3);var I=t[e+4]|t[e+5]<<8;s+=8191&(B>>>10|I<<6);var S=t[e+6]|t[e+7]<<8;a+=8191&(I>>>7|S<<9);var U=t[e+8]|t[e+9]<<8;c+=8191&(S>>>4|U<<12),h+=U>>>1&8191;var P=t[e+10]|t[e+11]<<8;u+=8191&(U>>>14|P<<2);var C=t[e+12]|t[e+13]<<8;f+=8191&(P>>>11|C<<5);var L=t[e+14]|t[e+15]<<8,D=0,k=D;k+=i*p,k+=o*(5*A),k+=s*(5*x),k+=a*(5*E),D=(k+=c*(5*v))>>>13,k&=8191,k+=h*(5*m),k+=u*(5*b),k+=f*(5*g),k+=(d+=8191&(C>>>8|L<<8))*(5*w);var O=D+=(k+=(l+=L>>>5|n)*(5*y))>>>13;O+=i*y,O+=o*p,O+=s*(5*A),O+=a*(5*x),D=(O+=c*(5*E))>>>13,O&=8191,O+=h*(5*v),O+=u*(5*m),O+=f*(5*b),O+=d*(5*g),D+=(O+=l*(5*w))>>>13,O&=8191;var T=D;T+=i*w,T+=o*y,T+=s*p,T+=a*(5*A),D=(T+=c*(5*x))>>>13,T&=8191,T+=h*(5*E),T+=u*(5*v),T+=f*(5*m),T+=d*(5*b);var N=D+=(T+=l*(5*g))>>>13;N+=i*g,N+=o*w,N+=s*y,N+=a*p,D=(N+=c*(5*A))>>>13,N&=8191,N+=h*(5*x),N+=u*(5*E),N+=f*(5*v),N+=d*(5*m);var R=D+=(N+=l*(5*b))>>>13;R+=i*b,R+=o*g,R+=s*w,R+=a*y,D=(R+=c*p)>>>13,R&=8191,R+=h*(5*A),R+=u*(5*x),R+=f*(5*E),R+=d*(5*v);var $=D+=(R+=l*(5*m))>>>13;$+=i*m,$+=o*b,$+=s*g,$+=a*w,D=($+=c*y)>>>13,$&=8191,$+=h*p,$+=u*(5*A),$+=f*(5*x),$+=d*(5*E);var K=D+=($+=l*(5*v))>>>13;K+=i*v,K+=o*m,K+=s*b,K+=a*g,D=(K+=c*w)>>>13,K&=8191,K+=h*y,K+=u*p,K+=f*(5*A),K+=d*(5*x);var j=D+=(K+=l*(5*E))>>>13;j+=i*E,j+=o*v,j+=s*m,j+=a*b,D=(j+=c*g)>>>13,j&=8191,j+=h*w,j+=u*y,j+=f*p,j+=d*(5*A);var V=D+=(j+=l*(5*x))>>>13;V+=i*x,V+=o*E,V+=s*v,V+=a*m,D=(V+=c*b)>>>13,V&=8191,V+=h*g,V+=u*w,V+=f*y,V+=d*p;var H=D+=(V+=l*(5*A))>>>13;H+=i*A,H+=o*x,H+=s*E,H+=a*v,D=(H+=c*m)>>>13,H&=8191,H+=h*b,H+=u*g,H+=f*w,H+=d*y,i=k=8191&(D=(D=((D+=(H+=l*p)>>>13)<<2)+D|0)+(k&=8191)|0),o=O+=D>>>=13,s=T&=8191,a=N&=8191,c=R&=8191,h=$&=8191,u=K&=8191,f=j&=8191,d=V&=8191,l=H&=8191,e+=16,r-=16}this._h[0]=i,this._h[1]=o,this._h[2]=s,this._h[3]=a,this._h[4]=c,this._h[5]=h,this._h[6]=u,this._h[7]=f,this._h[8]=d,this._h[9]=l},t.prototype.finish=function(t,e){void 0===e&&(e=0);var r,n,i,o,s=new Uint16Array(10);if(this._leftover){for(o=this._leftover,this._buffer[o++]=1;o<16;o++)this._buffer[o]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(r=this._h[1]>>>13,this._h[1]&=8191,o=2;o<10;o++)this._h[o]+=r,r=this._h[o]>>>13,this._h[o]&=8191;for(this._h[0]+=5*r,r=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=r,r=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=r,s[0]=this._h[0]+5,r=s[0]>>>13,s[0]&=8191,o=1;o<10;o++)s[o]=this._h[o]+r,r=s[o]>>>13,s[o]&=8191;for(s[9]-=8192,n=(1^r)-1,o=0;o<10;o++)s[o]&=n;for(n=~n,o=0;o<10;o++)this._h[o]=this._h[o]&n|s[o];for(this._h[0]=65535&(this._h[0]|this._h[1]<<13),this._h[1]=65535&(this._h[1]>>>3|this._h[2]<<10),this._h[2]=65535&(this._h[2]>>>6|this._h[3]<<7),this._h[3]=65535&(this._h[3]>>>9|this._h[4]<<4),this._h[4]=65535&(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14),this._h[5]=65535&(this._h[6]>>>2|this._h[7]<<11),this._h[6]=65535&(this._h[7]>>>5|this._h[8]<<8),this._h[7]=65535&(this._h[8]>>>8|this._h[9]<<5),i=this._h[0]+this._pad[0],this._h[0]=65535&i,o=1;o<8;o++)i=(this._h[o]+this._pad[o]|0)+(i>>>16)|0,this._h[o]=65535&i;return t[e+0]=this._h[0]>>>0,t[e+1]=this._h[0]>>>8,t[e+2]=this._h[1]>>>0,t[e+3]=this._h[1]>>>8,t[e+4]=this._h[2]>>>0,t[e+5]=this._h[2]>>>8,t[e+6]=this._h[3]>>>0,t[e+7]=this._h[3]>>>8,t[e+8]=this._h[4]>>>0,t[e+9]=this._h[4]>>>8,t[e+10]=this._h[5]>>>0,t[e+11]=this._h[5]>>>8,t[e+12]=this._h[6]>>>0,t[e+13]=this._h[6]>>>8,t[e+14]=this._h[7]>>>0,t[e+15]=this._h[7]>>>8,this._finished=!0,this},t.prototype.update=function(t){var e,r=0,n=t.length;if(this._leftover){(e=16-this._leftover)>n&&(e=n);for(var i=0;i<e;i++)this._buffer[this._leftover+i]=t[r+i];if(n-=e,r+=e,this._leftover+=e,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(n>=16&&(e=n-n%16,this._blocks(t,r,e),r+=e,n-=e),n){for(i=0;i<n;i++)this._buffer[this._leftover+i]=t[r+i];this._leftover+=n}return this},t.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var t=new Uint8Array(16);return this.finish(t),t},t.prototype.clean=function(){return i.wipe(this._buffer),i.wipe(this._r),i.wipe(this._h),i.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},t}();e.Poly1305=o,e.oneTimeAuth=function(t,e){var r=new o(t);r.update(e);var n=r.digest();return r.clean(),n},e.equal=function(t,r){return t.length===e.DIGEST_LENGTH&&r.length===e.DIGEST_LENGTH&&n.equal(t,r)}},309:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.wipe=function(t){for(var e=0;e<t.length;e++)t[e]=0;return t}},753:(t,e,r)=>{Object.defineProperty(e,"__esModule",{value:!0});var n=r(99),i=r(309),o=r(439);function s(t,e,r,n){if(24!==e.length)throw new Error("XChaCha20 nonce must be 24 bytes");var s=a(t,e.subarray(0,16),new Uint8Array(32)),c=new Uint8Array(12);c.set(e.subarray(16),4);var h=o.streamXOR(s,c,r,n);return i.wipe(s),h}function a(t,e,r){for(var i=1634760805,o=857760878,s=2036477234,a=1797285236,c=t[3]<<24|t[2]<<16|t[1]<<8|t[0],h=t[7]<<24|t[6]<<16|t[5]<<8|t[4],u=t[11]<<24|t[10]<<16|t[9]<<8|t[8],f=t[15]<<24|t[14]<<16|t[13]<<8|t[12],d=t[19]<<24|t[18]<<16|t[17]<<8|t[16],l=t[23]<<24|t[22]<<16|t[21]<<8|t[20],p=t[27]<<24|t[26]<<16|t[25]<<8|t[24],y=t[31]<<24|t[30]<<16|t[29]<<8|t[28],w=e[3]<<24|e[2]<<16|e[1]<<8|e[0],g=e[7]<<24|e[6]<<16|e[5]<<8|e[4],b=e[11]<<24|e[10]<<16|e[9]<<8|e[8],m=e[15]<<24|e[14]<<16|e[13]<<8|e[12],v=0;v<20;v+=2)c=(c^=d=d+(w=(w^=i=i+c|0)>>>16|w<<16)|0)>>>20|c<<12,h=(h^=l=l+(g=(g^=o=o+h|0)>>>16|g<<16)|0)>>>20|h<<12,u=(u^=p=p+(b=(b^=s=s+u|0)>>>16|b<<16)|0)>>>20|u<<12,f=(f^=y=y+(m=(m^=a=a+f|0)>>>16|m<<16)|0)>>>20|f<<12,u=(u^=p=p+(b=(b^=s=s+u|0)>>>24|b<<8)|0)>>>25|u<<7,f=(f^=y=y+(m=(m^=a=a+f|0)>>>24|m<<8)|0)>>>25|f<<7,h=(h^=l=l+(g=(g^=o=o+h|0)>>>24|g<<8)|0)>>>25|h<<7,c=(c^=d=d+(w=(w^=i=i+c|0)>>>24|w<<8)|0)>>>25|c<<7,h=(h^=p=p+(m=(m^=i=i+h|0)>>>16|m<<16)|0)>>>20|h<<12,u=(u^=y=y+(w=(w^=o=o+u|0)>>>16|w<<16)|0)>>>20|u<<12,f=(f^=d=d+(g=(g^=s=s+f|0)>>>16|g<<16)|0)>>>20|f<<12,c=(c^=l=l+(b=(b^=a=a+c|0)>>>16|b<<16)|0)>>>20|c<<12,f=(f^=d=d+(g=(g^=s=s+f|0)>>>24|g<<8)|0)>>>25|f<<7,c=(c^=l=l+(b=(b^=a=a+c|0)>>>24|b<<8)|0)>>>25|c<<7,u=(u^=y=y+(w=(w^=o=o+u|0)>>>24|w<<8)|0)>>>25|u<<7,h=(h^=p=p+(m=(m^=i=i+h|0)>>>24|m<<8)|0)>>>25|h<<7;return n.writeUint32LE(i,r,0),n.writeUint32LE(o,r,4),n.writeUint32LE(s,r,8),n.writeUint32LE(a,r,12),n.writeUint32LE(w,r,16),n.writeUint32LE(g,r,20),n.writeUint32LE(b,r,24),n.writeUint32LE(m,r,28),r}e.streamXOR=s,e.stream=function(t,e,r){return i.wipe(r),s(t,e,r,r)},e.hchacha=a},375:(t,e,r)=>{var n=r(753),i=r(501),o=r(309);e.Cv=32,e.WH=24,e.pg=16;var s=function(){function t(t){if(this.nonceLength=e.WH,this.tagLength=e.pg,t.length!==e.Cv)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(t)}return t.prototype.seal=function(t,e,r,s){if(24!==t.length)throw new Error("XChaCha20Poly1305: incorrect nonce length");var a=n.hchacha(this._key,t.subarray(0,16),new Uint8Array(32)),c=new Uint8Array(12);c.set(t.subarray(16),4);var h=new i.ChaCha20Poly1305(a),u=h.seal(c,e,r,s);return o.wipe(a),o.wipe(c),h.clean(),u},t.prototype.open=function(t,e,r,s){if(24!==t.length)throw new Error("XChaCha20Poly1305: incorrect nonce length");if(e.length<this.tagLength)return null;var a=n.hchacha(this._key,t.subarray(0,16),new Uint8Array(32)),c=new Uint8Array(12);c.set(t.subarray(16),4);var h=new i.ChaCha20Poly1305(a),u=h.open(c,e,r,s);return o.wipe(a),o.wipe(c),h.clean(),u},t.prototype.clean=function(){return o.wipe(this._key),this},t}();e.NV=s},715:(t,e)=>{e.gW=void 0;const r="qpzry9x8gf2tvdw0s3jn54khce6mua7l",n={};for(let t=0;t<r.length;t++){const e=r.charAt(t);n[e]=t}function i(t){const e=t>>25;return(33554431&t)<<5^996825010&-(e>>0&1)^642813549&-(e>>1&1)^513874426&-(e>>2&1)^1027748829&-(e>>3&1)^705979059&-(e>>4&1)}function o(t){let e=1;for(let r=0;r<t.length;++r){const n=t.charCodeAt(r);if(n<33||n>126)return"Invalid prefix ("+t+")";e=i(e)^n>>5}e=i(e);for(let r=0;r<t.length;++r){const n=t.charCodeAt(r);e=i(e)^31&n}return e}function s(t,e,r,n){let i=0,o=0;const s=(1<<r)-1,a=[];for(let n=0;n<t.length;++n)for(i=i<<e|t[n],o+=e;o>=r;)o-=r,a.push(i>>o&s);if(n)o>0&&a.push(i<<r-o&s);else{if(o>=e)return"Excess padding";if(i<<r-o&s)return"Non-zero padding"}return a}function a(t){return s(t,8,5,!0)}function c(t){const e=s(t,5,8,!1);if(Array.isArray(e))return e}function h(t){const e=s(t,5,8,!1);if(Array.isArray(e))return e;throw new Error(e)}function u(t){let e;function s(t,r){if(r=r||90,t.length<8)return t+" too short";if(t.length>r)return"Exceeds length limit";const s=t.toLowerCase(),a=t.toUpperCase();if(t!==s&&t!==a)return"Mixed-case string "+t;const c=(t=s).lastIndexOf("1");if(-1===c)return"No separator character for "+t;if(0===c)return"Missing prefix for "+t;const h=t.slice(0,c),u=t.slice(c+1);if(u.length<6)return"Data too short";let f=o(h);if("string"==typeof f)return f;const d=[];for(let t=0;t<u.length;++t){const e=u.charAt(t),r=n[e];if(void 0===r)return"Unknown character "+e;f=i(f)^r,t+6>=u.length||d.push(r)}return f!==e?"Invalid checksum for "+t:{prefix:h,words:d}}return e="bech32"===t?1:734539939,{decodeUnsafe:function(t,e){const r=s(t,e);if("object"==typeof r)return r},decode:function(t,e){const r=s(t,e);if("object"==typeof r)return r;throw new Error(r)},encode:function(t,n,s){if(s=s||90,t.length+7+n.length>s)throw new TypeError("Exceeds length limit");let a=o(t=t.toLowerCase());if("string"==typeof a)throw new Error(a);let c=t+"1";for(let t=0;t<n.length;++t){const e=n[t];if(e>>5!=0)throw new Error("Non 5-bit word");a=i(a)^e,c+=r.charAt(e)}for(let t=0;t<6;++t)a=i(a);a^=e;for(let t=0;t<6;++t)c+=r.charAt(a>>5*(5-t)&31);return c},toWords:a,fromWordsUnsafe:c,fromWords:h}}e.gW=u("bech32"),u("bech32m")},456:t=>{t.exports=function t(e){if("number"==typeof e&&isNaN(e))throw new Error("NaN is not allowed");if("number"==typeof e&&!isFinite(e))throw new Error("Infinity is not allowed");return null===e||"object"!=typeof e?JSON.stringify(e):e.toJSON instanceof Function?t(e.toJSON()):Array.isArray(e)?`[${e.reduce(((e,r,n)=>`${e}${0===n?"":","}${t(void 0===r||"symbol"==typeof r?null:r)}`),"")}]`:`{${Object.keys(e).sort().reduce(((r,n)=>void 0===e[n]||"symbol"==typeof e[n]?r:`${r}${0===r.length?"":","}${t(n)}:${t(e[n])}`),"")}}`}}},e={};function r(n){var i=e[n];if(void 0!==i)return i.exports;var o=e[n]={exports:{}};return t[n](o,o.exports,r),o.exports}r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};(()=>{r.d(n,{_D:()=>us,qT:()=>ys,vo:()=>ls,_J:()=>ds,Fh:()=>Ss,Qu:()=>ps,R8:()=>fs,Ks:()=>Fo,K9:()=>zo,kr:()=>ya,Gp:()=>la,Qf:()=>hs,_6:()=>xa,ax:()=>va,P9:()=>Ea,aD:()=>ma,I7:()=>ga,zO:()=>ca,pk:()=>zs,XX:()=>Hs,qK:()=>Vs,yv:()=>wa,xK:()=>pa,fq:()=>da,xp:()=>Qs,jB:()=>aa,bK:()=>ns,nr:()=>qo,AX:()=>ba,Mq:()=>ss,ZW:()=>ea,PZ:()=>js,Y:()=>Ua,Qv:()=>Ba,$1:()=>Ca,_I:()=>Sa,UR:()=>fa,C2:()=>ua});var t={};r.r(t),r.d(t,{identity:()=>F});var e={};r.r(e),r.d(e,{base2:()=>q});var i={};r.r(i),r.d(i,{base8:()=>W});var o={};r.r(o),r.d(o,{base10:()=>J});var s={};r.r(s),r.d(s,{base16:()=>M,base16upper:()=>G});var a={};r.r(a),r.d(a,{base32:()=>X,base32hex:()=>tt,base32hexpad:()=>rt,base32hexpadupper:()=>nt,base32hexupper:()=>et,base32pad:()=>Y,base32padupper:()=>Q,base32upper:()=>Z,base32z:()=>it});var c={};r.r(c),r.d(c,{base36:()=>ot,base36upper:()=>st});var h={};r.r(h),r.d(h,{base58btc:()=>at,base58flickr:()=>ct});var u={};r.r(u),r.d(u,{base64:()=>ht,base64pad:()=>ut,base64url:()=>ft,base64urlpad:()=>dt});var f={};r.r(f),r.d(f,{base256emoji:()=>wt});var d={};r.r(d),r.d(d,{sha256:()=>Nt,sha512:()=>Rt});var l={};r.r(l),r.d(l,{identity:()=>Kt});var p={};r.r(p),r.d(p,{code:()=>Vt,decode:()=>zt,encode:()=>Ht,name:()=>jt});var y={};r.r(y),r.d(y,{code:()=>Jt,decode:()=>Gt,encode:()=>Mt,name:()=>Wt});var w={};r.r(w),r.d(w,{identity:()=>pe});var g={};r.r(g),r.d(g,{base2:()=>ye});var b={};r.r(b),r.d(b,{base8:()=>we});var m={};r.r(m),r.d(m,{base10:()=>ge});var v={};r.r(v),r.d(v,{base16:()=>be,base16upper:()=>me});var E={};r.r(E),r.d(E,{base32:()=>ve,base32hex:()=>_e,base32hexpad:()=>Ie,base32hexpadupper:()=>Se,base32hexupper:()=>Be,base32pad:()=>xe,base32padupper:()=>Ae,base32upper:()=>Ee,base32z:()=>Ue});var x={};r.r(x),r.d(x,{base36:()=>Pe,base36upper:()=>Ce});var A={};r.r(A),r.d(A,{base58btc:()=>Le,base58flickr:()=>De});var _={};r.r(_),r.d(_,{base64:()=>ke,base64pad:()=>Oe,base64url:()=>Te,base64urlpad:()=>Ne});var B={};r.r(B),r.d(B,{base256emoji:()=>je});var I={};r.r(I),r.d(I,{sha256:()=>sr,sha512:()=>ar});var S={};r.r(S),r.d(S,{identity:()=>hr});var U={};r.r(U),r.d(U,{code:()=>fr,decode:()=>lr,encode:()=>dr,name:()=>ur});var P={};r.r(P),r.d(P,{code:()=>gr,decode:()=>mr,encode:()=>br,name:()=>wr});var C={};function L(t){return null!=globalThis.Buffer?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function D(t=0){return null!=globalThis.Buffer?.allocUnsafe?L(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function k(t,e){null==e&&(e=t.reduce(((t,e)=>t+e.length),0));const r=D(e);let n=0;for(const e of t)r.set(e,n),n+=e.length;return L(r)}r.r(C),r.d(C,{bitGet:()=>Dn,bitLen:()=>Ln,bitMask:()=>On,bitSet:()=>kn,bytesToHex:()=>bn,bytesToNumberBE:()=>xn,bytesToNumberLE:()=>An,concatBytes:()=>Un,createHmacDrbg:()=>Rn,ensureBytes:()=>Sn,equalBytes:()=>Pn,hexToBytes:()=>En,hexToNumber:()=>vn,numberToBytesBE:()=>_n,numberToBytesLE:()=>Bn,numberToHexUnpadded:()=>mn,numberToVarBytesBE:()=>In,utf8ToBytes:()=>Cn,validateObject:()=>Kn});const O=function(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var o=t.charAt(i),s=o.charCodeAt(0);if(255!==r[s])throw new TypeError(o+" is ambiguous");r[s]=i}var a=t.length,c=t.charAt(0),h=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function f(t){if("string"!=typeof t)throw new TypeError("Expected String");if(0===t.length)return new Uint8Array;var e=0;if(" "!==t[e]){for(var n=0,i=0;t[e]===c;)n++,e++;for(var o=(t.length-e)*h+1>>>0,s=new Uint8Array(o);t[e];){var u=r[t.charCodeAt(e)];if(255===u)return;for(var f=0,d=o-1;(0!==u||f<i)&&-1!==d;d--,f++)u+=a*s[d]>>>0,s[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=f,e++}if(" "!==t[e]){for(var l=o-i;l!==o&&0===s[l];)l++;for(var p=new Uint8Array(n+(o-l)),y=n;l!==o;)p[y++]=s[l++];return p}}}return{encode:function(e){if(e instanceof Uint8Array||(ArrayBuffer.isView(e)?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):Array.isArray(e)&&(e=Uint8Array.from(e))),!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===e.length)return"";for(var r=0,n=0,i=0,o=e.length;i!==o&&0===e[i];)i++,r++;for(var s=(o-i)*u+1>>>0,h=new Uint8Array(s);i!==o;){for(var f=e[i],d=0,l=s-1;(0!==f||d<n)&&-1!==l;l--,d++)f+=256*h[l]>>>0,h[l]=f%a>>>0,f=f/a>>>0;if(0!==f)throw new Error("Non-zero carry");n=d,i++}for(var p=s-n;p!==s&&0===h[p];)p++;for(var y=c.repeat(r);p<s;++p)y+=t.charAt(h[p]);return y},decodeUnsafe:f,decode:function(t){var r=f(t);if(r)return r;throw new Error(`Non-${e} character`)}}},T=(new Uint8Array(0),t=>{if(t instanceof Uint8Array&&"Uint8Array"===t.constructor.name)return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")});class N{constructor(t,e,r){this.name=t,this.prefix=e,this.baseEncode=r}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class R{constructor(t,e,r){if(this.name=t,this.prefix=e,void 0===e.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=e.codePointAt(0),this.baseDecode=r}decode(t){if("string"==typeof t){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(t){return K(this,t)}}class ${constructor(t){this.decoders=t}or(t){return K(this,t)}decode(t){const e=t[0],r=this.decoders[e];if(r)return r.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const K=(t,e)=>new $({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class j{constructor(t,e,r,n){this.name=t,this.prefix=e,this.baseEncode=r,this.baseDecode=n,this.encoder=new N(t,e,r),this.decoder=new R(t,e,n)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const V=({name:t,prefix:e,encode:r,decode:n})=>new j(t,e,r,n),H=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:i}=O(r,e);return V({prefix:t,name:e,encode:n,decode:t=>T(i(t))})},z=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>V({prefix:e,name:t,encode:t=>((t,e,r)=>{const n="="===e[e.length-1],i=(1<<r)-1;let o="",s=0,a=0;for(let n=0;n<t.length;++n)for(a=a<<8|t[n],s+=8;s>r;)s-=r,o+=e[i&a>>s];if(s&&(o+=e[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o})(t,n,r),decode:e=>((t,e,r,n)=>{const i={};for(let t=0;t<e.length;++t)i[e[t]]=t;let o=t.length;for(;"="===t[o-1];)--o;const s=new Uint8Array(o*r/8|0);let a=0,c=0,h=0;for(let e=0;e<o;++e){const o=i[t[e]];if(void 0===o)throw new SyntaxError(`Non-${n} character`);c=c<<r|o,a+=r,a>=8&&(a-=8,s[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(e,n,r,t)}),F=V({prefix:"\0",name:"identity",encode:t=>{return e=t,(new TextDecoder).decode(e);var e},decode:t=>(t=>(new TextEncoder).encode(t))(t)}),q=z({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),W=z({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),J=H({prefix:"9",name:"base10",alphabet:"0123456789"}),M=z({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),G=z({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),X=z({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Z=z({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Y=z({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Q=z({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),tt=z({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),et=z({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),rt=z({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),nt=z({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),it=z({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),ot=H({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),st=H({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),at=H({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),ct=H({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),ht=z({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),ut=z({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),ft=z({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),dt=z({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),lt=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),pt=lt.reduce(((t,e,r)=>(t[r]=e,t)),[]),yt=lt.reduce(((t,e,r)=>(t[e.codePointAt(0)]=r,t)),[]),wt=V({prefix:"🚀",name:"base256emoji",encode:function(t){return t.reduce(((t,e)=>t+pt[e]),"")},decode:function(t){const e=[];for(const r of t){const t=yt[r.codePointAt(0)];if(void 0===t)throw new Error(`Non-base256emoji character: ${r}`);e.push(t)}return new Uint8Array(e)}});var gt=Math.pow(2,31),bt=Math.pow(2,7),mt=Math.pow(2,14),vt=Math.pow(2,21),Et=Math.pow(2,28),xt=Math.pow(2,35),At=Math.pow(2,42),_t=Math.pow(2,49),Bt=Math.pow(2,56),It=Math.pow(2,63);const St=function t(e,r,n){r=r||[];for(var i=n=n||0;e>=gt;)r[n++]=255&e|128,e/=128;for(;-128&e;)r[n++]=255&e|128,e>>>=7;return r[n]=0|e,t.bytes=n-i+1,r},Ut=function(t){return t<bt?1:t<mt?2:t<vt?3:t<Et?4:t<xt?5:t<At?6:t<_t?7:t<Bt?8:t<It?9:10},Pt=(t,e,r=0)=>(St(t,e,r),e),Ct=t=>Ut(t),Lt=(t,e)=>{const r=e.byteLength,n=Ct(t),i=n+Ct(r),o=new Uint8Array(i+r);return Pt(t,o,0),Pt(r,o,n),o.set(e,i),new Dt(t,r,e,o)};class Dt{constructor(t,e,r,n){this.code=t,this.size=e,this.digest=r,this.bytes=n}}const kt=({name:t,code:e,encode:r})=>new Ot(t,e,r);class Ot{constructor(t,e,r){this.name=t,this.code=e,this.encode=r}digest(t){if(t instanceof Uint8Array){const e=this.encode(t);return e instanceof Uint8Array?Lt(this.code,e):e.then((t=>Lt(this.code,t)))}throw Error("Unknown type, must be binary type")}}const Tt=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Nt=kt({name:"sha2-256",code:18,encode:Tt("SHA-256")}),Rt=kt({name:"sha2-512",code:19,encode:Tt("SHA-512")}),$t=T,Kt={code:0,name:"identity",encode:$t,digest:t=>Lt(0,$t(t))},jt="raw",Vt=85,Ht=t=>T(t),zt=t=>T(t),Ft=new TextEncoder,qt=new TextDecoder,Wt="json",Jt=512,Mt=t=>Ft.encode(JSON.stringify(t)),Gt=t=>JSON.parse(qt.decode(t));new WeakMap;class Xt{constructor(t,e,r,n){this.code=e,this.version=t,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:t,multihash:e}=this;if(t!==DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(e.code!==SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Xt.createV0(e)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:t,digest:e}=this.multihash,r=Digest.create(t,e);return Xt.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return Xt.equals(this,t)}static equals(t,e){const r=e;return r&&t.code===r.code&&t.version===r.version&&Digest.equals(t.multihash,r.multihash)}toString(t){return format(this,t)}toJSON(){return{"/":format(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(null==t)return null;const e=t;if(e instanceof Xt)return e;if(null!=e["/"]&&e["/"]===e.bytes||e.asCID===e){const{version:t,code:r,multihash:n,bytes:i}=e;return new Xt(t,r,n,i||encodeCID(t,r,n.bytes))}if(!0===e[cidSymbol]){const{version:t,multihash:r,code:n}=e,i=Digest.decode(r);return Xt.create(t,n,i)}return null}static create(t,e,r){if("number"!=typeof e)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:if(e!==DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE}) block encoding`);return new Xt(t,e,r,r.bytes);case 1:{const n=encodeCID(t,e,r.bytes);return new Xt(t,e,r,n)}default:throw new Error("Invalid version")}}static createV0(t){return Xt.create(0,DAG_PB_CODE,t)}static createV1(t,e){return Xt.create(1,t,e)}static decode(t){const[e,r]=Xt.decodeFirst(t);if(r.length)throw new Error("Incorrect length");return e}static decodeFirst(t){const e=Xt.inspectBytes(t),r=e.size-e.multihashSize,n=coerce(t.subarray(r,r+e.multihashSize));if(n.byteLength!==e.multihashSize)throw new Error("Incorrect length");const i=n.subarray(e.multihashSize-e.digestSize),o=new Digest.Digest(e.multihashCode,e.digestSize,i,n);return[0===e.version?Xt.createV0(o):Xt.createV1(e.codec,o),t.subarray(e.size)]}static inspectBytes(t){const e=()=>{const[e,r]=varint.decode(t.subarray(0));return e};let r=e(),n=DAG_PB_CODE;if(18===r||e(),0!==r&&1!==r)throw new RangeError(`Invalid CID version ${r}`);const i=e(),o=e(),s=0+o;return{version:r,codec:n,multihashCode:i,digestSize:o,multihashSize:s-0,size:s}}static parse(t,e){const[r,n]=parseCIDtoBytes(t,e),i=Xt.decode(n);if(0===i.version&&"Q"!==t[0])throw Error("Version 0 CID string must not include multibase prefix");return baseCache(i).set(r,t),i}}Symbol.for("@ipld/js-cid/CID");const Zt={...t,...e,...i,...o,...s,...a,...c,...h,...u,...f};function Yt(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const Qt=Yt("utf8","u",(t=>"u"+new TextDecoder("utf8").decode(t)),(t=>(new TextEncoder).encode(t.substring(1)))),te=Yt("ascii","a",(t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e}),(t=>{const e=D((t=t.substring(1)).length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e})),ee={utf8:Qt,"utf-8":Qt,hex:Zt.base16,latin1:te,ascii:te,binary:te,...Zt};function re(t,e="utf8"){const r=ee[e];if(null==r)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?r.decoder.decode(`${r.prefix}${t}`):L(globalThis.Buffer.from(t,"utf-8"))}function ne(t,e="utf8"){const r=ee[e];if(null==r)throw new Error(`Unsupported encoding "${e}"`);return"utf8"!==e&&"utf-8"!==e||null==globalThis.Buffer||null==globalThis.Buffer.from?r.encoder.encode(t).substring(1):globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8")}const ie=function(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var o=t.charAt(i),s=o.charCodeAt(0);if(255!==r[s])throw new TypeError(o+" is ambiguous");r[s]=i}var a=t.length,c=t.charAt(0),h=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function f(t){if("string"!=typeof t)throw new TypeError("Expected String");if(0===t.length)return new Uint8Array;var e=0;if(" "!==t[e]){for(var n=0,i=0;t[e]===c;)n++,e++;for(var o=(t.length-e)*h+1>>>0,s=new Uint8Array(o);t[e];){var u=r[t.charCodeAt(e)];if(255===u)return;for(var f=0,d=o-1;(0!==u||f<i)&&-1!==d;d--,f++)u+=a*s[d]>>>0,s[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");i=f,e++}if(" "!==t[e]){for(var l=o-i;l!==o&&0===s[l];)l++;for(var p=new Uint8Array(n+(o-l)),y=n;l!==o;)p[y++]=s[l++];return p}}}return{encode:function(e){if(e instanceof Uint8Array||(ArrayBuffer.isView(e)?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):Array.isArray(e)&&(e=Uint8Array.from(e))),!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===e.length)return"";for(var r=0,n=0,i=0,o=e.length;i!==o&&0===e[i];)i++,r++;for(var s=(o-i)*u+1>>>0,h=new Uint8Array(s);i!==o;){for(var f=e[i],d=0,l=s-1;(0!==f||d<n)&&-1!==l;l--,d++)f+=256*h[l]>>>0,h[l]=f%a>>>0,f=f/a>>>0;if(0!==f)throw new Error("Non-zero carry");n=d,i++}for(var p=s-n;p!==s&&0===h[p];)p++;for(var y=c.repeat(r);p<s;++p)y+=t.charAt(h[p]);return y},decodeUnsafe:f,decode:function(t){var r=f(t);if(r)return r;throw new Error(`Non-${e} character`)}}},oe=(new Uint8Array(0),t=>{if(t instanceof Uint8Array&&"Uint8Array"===t.constructor.name)return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")});class se{constructor(t,e,r){this.name=t,this.prefix=e,this.baseEncode=r}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class ae{constructor(t,e,r){if(this.name=t,this.prefix=e,void 0===e.codePointAt(0))throw new Error("Invalid prefix character");this.prefixCodePoint=e.codePointAt(0),this.baseDecode=r}decode(t){if("string"==typeof t){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(t){return he(this,t)}}class ce{constructor(t){this.decoders=t}or(t){return he(this,t)}decode(t){const e=t[0],r=this.decoders[e];if(r)return r.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const he=(t,e)=>new ce({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class ue{constructor(t,e,r,n){this.name=t,this.prefix=e,this.baseEncode=r,this.baseDecode=n,this.encoder=new se(t,e,r),this.decoder=new ae(t,e,n)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const fe=({name:t,prefix:e,encode:r,decode:n})=>new ue(t,e,r,n),de=({prefix:t,name:e,alphabet:r})=>{const{encode:n,decode:i}=ie(r,e);return fe({prefix:t,name:e,encode:n,decode:t=>oe(i(t))})},le=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>fe({prefix:e,name:t,encode:t=>((t,e,r)=>{const n="="===e[e.length-1],i=(1<<r)-1;let o="",s=0,a=0;for(let n=0;n<t.length;++n)for(a=a<<8|t[n],s+=8;s>r;)s-=r,o+=e[i&a>>s];if(s&&(o+=e[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o})(t,n,r),decode:e=>((t,e,r,n)=>{const i={};for(let t=0;t<e.length;++t)i[e[t]]=t;let o=t.length;for(;"="===t[o-1];)--o;const s=new Uint8Array(o*r/8|0);let a=0,c=0,h=0;for(let e=0;e<o;++e){const o=i[t[e]];if(void 0===o)throw new SyntaxError(`Non-${n} character`);c=c<<r|o,a+=r,a>=8&&(a-=8,s[h++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s})(e,n,r,t)}),pe=fe({prefix:"\0",name:"identity",encode:t=>{return e=t,(new TextDecoder).decode(e);var e},decode:t=>(t=>(new TextEncoder).encode(t))(t)}),ye=le({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),we=le({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),ge=de({prefix:"9",name:"base10",alphabet:"0123456789"}),be=le({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),me=le({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),ve=le({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ee=le({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),xe=le({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Ae=le({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),_e=le({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Be=le({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Ie=le({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Se=le({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Ue=le({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Pe=de({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Ce=de({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Le=de({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),De=de({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),ke=le({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Oe=le({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Te=le({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Ne=le({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Re=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),$e=Re.reduce(((t,e,r)=>(t[r]=e,t)),[]),Ke=Re.reduce(((t,e,r)=>(t[e.codePointAt(0)]=r,t)),[]),je=fe({prefix:"🚀",name:"base256emoji",encode:function(t){return t.reduce(((t,e)=>t+$e[e]),"")},decode:function(t){const e=[];for(const r of t){const t=Ke[r.codePointAt(0)];if(void 0===t)throw new Error(`Non-base256emoji character: ${r}`);e.push(t)}return new Uint8Array(e)}});var Ve=Math.pow(2,31),He=Math.pow(2,7),ze=Math.pow(2,14),Fe=Math.pow(2,21),qe=Math.pow(2,28),We=Math.pow(2,35),Je=Math.pow(2,42),Me=Math.pow(2,49),Ge=Math.pow(2,56),Xe=Math.pow(2,63);const Ze=function t(e,r,n){r=r||[];for(var i=n=n||0;e>=Ve;)r[n++]=255&e|128,e/=128;for(;-128&e;)r[n++]=255&e|128,e>>>=7;return r[n]=0|e,t.bytes=n-i+1,r},Ye=function(t){return t<He?1:t<ze?2:t<Fe?3:t<qe?4:t<We?5:t<Je?6:t<Me?7:t<Ge?8:t<Xe?9:10},Qe=(t,e,r=0)=>(Ze(t,e,r),e),tr=t=>Ye(t),er=(t,e)=>{const r=e.byteLength,n=tr(t),i=n+tr(r),o=new Uint8Array(i+r);return Qe(t,o,0),Qe(r,o,n),o.set(e,i),new rr(t,r,e,o)};class rr{constructor(t,e,r,n){this.code=t,this.size=e,this.digest=r,this.bytes=n}}const nr=({name:t,code:e,encode:r})=>new ir(t,e,r);class ir{constructor(t,e,r){this.name=t,this.code=e,this.encode=r}digest(t){if(t instanceof Uint8Array){const e=this.encode(t);return e instanceof Uint8Array?er(this.code,e):e.then((t=>er(this.code,t)))}throw Error("Unknown type, must be binary type")}}const or=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),sr=nr({name:"sha2-256",code:18,encode:or("SHA-256")}),ar=nr({name:"sha2-512",code:19,encode:or("SHA-512")}),cr=oe,hr={code:0,name:"identity",encode:cr,digest:t=>er(0,cr(t))},ur="raw",fr=85,dr=t=>oe(t),lr=t=>oe(t),pr=new TextEncoder,yr=new TextDecoder,wr="json",gr=512,br=t=>pr.encode(JSON.stringify(t)),mr=t=>JSON.parse(yr.decode(t));new WeakMap;class vr{constructor(t,e,r,n){this.code=e,this.version=t,this.multihash=r,this.bytes=n,this["/"]=n}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:t,multihash:e}=this;if(t!==cid_DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(e.code!==cid_SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return vr.createV0(e)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:t,digest:e}=this.multihash,r=Digest.create(t,e);return vr.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return vr.equals(this,t)}static equals(t,e){const r=e;return r&&t.code===r.code&&t.version===r.version&&Digest.equals(t.multihash,r.multihash)}toString(t){return cid_format(this,t)}toJSON(){return{"/":cid_format(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(null==t)return null;const e=t;if(e instanceof vr)return e;if(null!=e["/"]&&e["/"]===e.bytes||e.asCID===e){const{version:t,code:r,multihash:n,bytes:i}=e;return new vr(t,r,n,i||cid_encodeCID(t,r,n.bytes))}if(!0===e[cid_cidSymbol]){const{version:t,multihash:r,code:n}=e,i=Digest.decode(r);return vr.create(t,n,i)}return null}static create(t,e,r){if("number"!=typeof e)throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:if(e!==cid_DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${cid_DAG_PB_CODE}) block encoding`);return new vr(t,e,r,r.bytes);case 1:{const n=cid_encodeCID(t,e,r.bytes);return new vr(t,e,r,n)}default:throw new Error("Invalid version")}}static createV0(t){return vr.create(0,cid_DAG_PB_CODE,t)}static createV1(t,e){return vr.create(1,t,e)}static decode(t){const[e,r]=vr.decodeFirst(t);if(r.length)throw new Error("Incorrect length");return e}static decodeFirst(t){const e=vr.inspectBytes(t),r=e.size-e.multihashSize,n=coerce(t.subarray(r,r+e.multihashSize));if(n.byteLength!==e.multihashSize)throw new Error("Incorrect length");const i=n.subarray(e.multihashSize-e.digestSize),o=new Digest.Digest(e.multihashCode,e.digestSize,i,n);return[0===e.version?vr.createV0(o):vr.createV1(e.codec,o),t.subarray(e.size)]}static inspectBytes(t){const e=()=>{const[e,r]=varint.decode(t.subarray(0));return e};let r=e(),n=cid_DAG_PB_CODE;if(18===r||e(),0!==r&&1!==r)throw new RangeError(`Invalid CID version ${r}`);const i=e(),o=e(),s=0+o;return{version:r,codec:n,multihashCode:i,digestSize:o,multihashSize:s-0,size:s}}static parse(t,e){const[r,n]=cid_parseCIDtoBytes(t,e),i=vr.decode(n);if(0===i.version&&"Q"!==t[0])throw Error("Version 0 CID string must not include multibase prefix");return cid_baseCache(i).set(r,t),i}}Symbol.for("@ipld/js-cid/CID");const Er={...w,...g,...b,...m,...v,...E,...x,...A,..._,...B};function xr(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function Ar(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}const _r={number:xr,bool:function(t){if("boolean"!=typeof t)throw new Error(`Expected boolean, not ${t}`)},bytes:Ar,hash:function(t){if("function"!=typeof t||"function"!=typeof t.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");xr(t.outputLen),xr(t.blockLen)},exists:function(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")},output:function(t,e){Ar(t);const r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}},Br="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,Ir=t=>t instanceof Uint8Array,Sr=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),Ur=(t,e)=>t<<32-e|t>>>e;if(68!==new Uint8Array(new Uint32Array([287454020]).buffer)[0])throw new Error("Non little-endian hardware is not supported");function Pr(t){if("string"!=typeof t)throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))}function Cr(t){if("string"==typeof t&&(t=Pr(t)),!Ir(t))throw new Error("expected Uint8Array, got "+typeof t);return t}function Lr(...t){const e=new Uint8Array(t.reduce(((t,e)=>t+e.length),0));let r=0;return t.forEach((t=>{if(!Ir(t))throw new Error("Uint8Array expected");e.set(t,r),r+=t.length})),e}Array.from({length:256},((t,e)=>e.toString(16).padStart(2,"0")));class Dr{clone(){return this._cloneInto()}}function kr(t){const e=e=>t().update(Cr(e)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function Or(t=32){if(Br&&"function"==typeof Br.getRandomValues)return Br.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}class Tr extends Dr{constructor(t,e,r,n){super(),this.blockLen=t,this.outputLen=e,this.padOffset=r,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Sr(this.buffer)}update(t){_r.exists(this);const{view:e,buffer:r,blockLen:n}=this,i=(t=Cr(t)).length;for(let o=0;o<i;){const s=Math.min(n-this.pos,i-o);if(s!==n)r.set(t.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===n&&(this.process(e,0),this.pos=0);else{const e=Sr(t);for(;n<=i-o;o+=n)this.process(e,o)}}return this.length+=t.length,this.roundClean(),this}digestInto(t){_r.exists(this),_r.output(t,this),this.finished=!0;const{buffer:e,view:r,blockLen:n,isLE:i}=this;let{pos:o}=this;e[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>n-o&&(this.process(r,0),o=0);for(let t=o;t<n;t++)e[t]=0;!function(t,e,r,n){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,r,n);const i=BigInt(32),o=BigInt(4294967295),s=Number(r>>i&o),a=Number(r&o),c=n?4:0,h=n?0:4;t.setUint32(e+c,s,n),t.setUint32(e+h,a,n)}(r,n-8,BigInt(8*this.length),i),this.process(r,0);const s=Sr(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const c=a/4,h=this.get();if(c>h.length)throw new Error("_sha2: outputLen bigger than state");for(let t=0;t<c;t++)s.setUint32(4*t,h[t],i)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const r=t.slice(0,e);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:r,length:n,finished:i,destroyed:o,pos:s}=this;return t.length=n,t.pos=s,t.finished=i,t.destroyed=o,n%e&&t.buffer.set(r),t}}const Nr=BigInt(2**32-1),Rr=BigInt(32);function $r(t,e=!1){return e?{h:Number(t&Nr),l:Number(t>>Rr&Nr)}:{h:0|Number(t>>Rr&Nr),l:0|Number(t&Nr)}}const Kr=function(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){const{h:o,l:s}=$r(t[i],e);[r[i],n[i]]=[o,s]}return[r,n]},jr=(t,e,r)=>t>>>r,Vr=(t,e,r)=>t<<32-r|e>>>r,Hr=(t,e,r)=>t>>>r|e<<32-r,zr=(t,e,r)=>t<<32-r|e>>>r,Fr=(t,e,r)=>t<<64-r|e>>>r-32,qr=(t,e,r)=>t>>>r-32|e<<64-r,Wr=(t,e,r)=>t<<r|e>>>32-r,Jr=(t,e,r)=>e<<r|t>>>32-r,Mr=(t,e,r)=>e<<r-32|t>>>64-r,Gr=(t,e,r)=>t<<r-32|e>>>64-r,Xr=function(t,e,r,n){const i=(e>>>0)+(n>>>0);return{h:t+r+(i/2**32|0)|0,l:0|i}},Zr=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),Yr=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,Qr=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),tn=(t,e,r,n,i)=>e+r+n+i+(t/2**32|0)|0,en=(t,e,r,n,i,o)=>e+r+n+i+o+(t/2**32|0)|0,rn=(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0),[nn,on]=Kr(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((t=>BigInt(t)))),sn=new Uint32Array(80),an=new Uint32Array(80);class cn extends Tr{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:e,Bh:r,Bl:n,Ch:i,Cl:o,Dh:s,Dl:a,Eh:c,El:h,Fh:u,Fl:f,Gh:d,Gl:l,Hh:p,Hl:y}=this;return[t,e,r,n,i,o,s,a,c,h,u,f,d,l,p,y]}set(t,e,r,n,i,o,s,a,c,h,u,f,d,l,p,y){this.Ah=0|t,this.Al=0|e,this.Bh=0|r,this.Bl=0|n,this.Ch=0|i,this.Cl=0|o,this.Dh=0|s,this.Dl=0|a,this.Eh=0|c,this.El=0|h,this.Fh=0|u,this.Fl=0|f,this.Gh=0|d,this.Gl=0|l,this.Hh=0|p,this.Hl=0|y}process(t,e){for(let r=0;r<16;r++,e+=4)sn[r]=t.getUint32(e),an[r]=t.getUint32(e+=4);for(let t=16;t<80;t++){const e=0|sn[t-15],r=0|an[t-15],n=Hr(e,r,1)^Hr(e,r,8)^jr(e,r,7),i=zr(e,r,1)^zr(e,r,8)^Vr(e,r,7),o=0|sn[t-2],s=0|an[t-2],a=Hr(o,s,19)^Fr(o,s,61)^jr(o,s,6),c=zr(o,s,19)^qr(o,s,61)^Vr(o,s,6),h=Qr(i,c,an[t-7],an[t-16]),u=tn(h,n,a,sn[t-7],sn[t-16]);sn[t]=0|u,an[t]=0|h}let{Ah:r,Al:n,Bh:i,Bl:o,Ch:s,Cl:a,Dh:c,Dl:h,Eh:u,El:f,Fh:d,Fl:l,Gh:p,Gl:y,Hh:w,Hl:g}=this;for(let t=0;t<80;t++){const e=Hr(u,f,14)^Hr(u,f,18)^Fr(u,f,41),b=zr(u,f,14)^zr(u,f,18)^qr(u,f,41),m=u&d^~u&p,v=rn(g,b,f&l^~f&y,on[t],an[t]),E=en(v,w,e,m,nn[t],sn[t]),x=0|v,A=Hr(r,n,28)^Fr(r,n,34)^Fr(r,n,39),_=zr(r,n,28)^qr(r,n,34)^qr(r,n,39),B=r&i^r&s^i&s,I=n&o^n&a^o&a;w=0|p,g=0|y,p=0|d,y=0|l,d=0|u,l=0|f,({h:u,l:f}=Xr(0|c,0|h,0|E,0|x)),c=0|s,h=0|a,s=0|i,a=0|o,i=0|r,o=0|n;const S=Zr(x,_,I);r=Yr(S,E,A,B),n=0|S}({h:r,l:n}=Xr(0|this.Ah,0|this.Al,0|r,0|n)),({h:i,l:o}=Xr(0|this.Bh,0|this.Bl,0|i,0|o)),({h:s,l:a}=Xr(0|this.Ch,0|this.Cl,0|s,0|a)),({h:c,l:h}=Xr(0|this.Dh,0|this.Dl,0|c,0|h)),({h:u,l:f}=Xr(0|this.Eh,0|this.El,0|u,0|f)),({h:d,l}=Xr(0|this.Fh,0|this.Fl,0|d,0|l)),({h:p,l:y}=Xr(0|this.Gh,0|this.Gl,0|p,0|y)),({h:w,l:g}=Xr(0|this.Hh,0|this.Hl,0|w,0|g)),this.set(r,n,i,o,s,a,c,h,u,f,d,l,p,y,w,g)}roundClean(){sn.fill(0),an.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class hn extends cn{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}}class un extends cn{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}}class fn extends cn{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}const dn=kr((()=>new cn)),ln=(kr((()=>new hn)),kr((()=>new un)),kr((()=>new fn)),BigInt(0)),pn=BigInt(1),yn=BigInt(2),wn=t=>t instanceof Uint8Array,gn=Array.from({length:256},((t,e)=>e.toString(16).padStart(2,"0")));function bn(t){if(!wn(t))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=gn[t[r]];return e}function mn(t){const e=t.toString(16);return 1&e.length?`0${e}`:e}function vn(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);return BigInt(""===t?"0":`0x${t}`)}function En(t){if("string"!=typeof t)throw new Error("hex string expected, got "+typeof t);const e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(e/2);for(let e=0;e<r.length;e++){const n=2*e,i=t.slice(n,n+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");r[e]=o}return r}function xn(t){return vn(bn(t))}function An(t){if(!wn(t))throw new Error("Uint8Array expected");return vn(bn(Uint8Array.from(t).reverse()))}function _n(t,e){return En(t.toString(16).padStart(2*e,"0"))}function Bn(t,e){return _n(t,e).reverse()}function In(t){return En(mn(t))}function Sn(t,e,r){let n;if("string"==typeof e)try{n=En(e)}catch(r){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${r}`)}else{if(!wn(e))throw new Error(`${t} must be hex string or Uint8Array`);n=Uint8Array.from(e)}const i=n.length;if("number"==typeof r&&i!==r)throw new Error(`${t} expected ${r} bytes, got ${i}`);return n}function Un(...t){const e=new Uint8Array(t.reduce(((t,e)=>t+e.length),0));let r=0;return t.forEach((t=>{if(!wn(t))throw new Error("Uint8Array expected");e.set(t,r),r+=t.length})),e}function Pn(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function Cn(t){if("string"!=typeof t)throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))}function Ln(t){let e;for(e=0;t>ln;t>>=pn,e+=1);return e}function Dn(t,e){return t>>BigInt(e)&pn}const kn=(t,e,r)=>t|(r?pn:ln)<<BigInt(e),On=t=>(yn<<BigInt(t-1))-pn,Tn=t=>new Uint8Array(t),Nn=t=>Uint8Array.from(t);function Rn(t,e,r){if("number"!=typeof t||t<2)throw new Error("hashLen must be a number");if("number"!=typeof e||e<2)throw new Error("qByteLen must be a number");if("function"!=typeof r)throw new Error("hmacFn must be a function");let n=Tn(t),i=Tn(t),o=0;const s=()=>{n.fill(1),i.fill(0),o=0},a=(...t)=>r(i,n,...t),c=(t=Tn())=>{i=a(Nn([0]),t),n=a(),0!==t.length&&(i=a(Nn([1]),t),n=a())},h=()=>{if(o++>=1e3)throw new Error("drbg: tried 1000 values");let t=0;const r=[];for(;t<e;){n=a();const e=n.slice();r.push(e),t+=n.length}return Un(...r)};return(t,e)=>{let r;for(s(),c(t);!(r=e(h()));)c();return s(),r}}const $n={bigint:t=>"bigint"==typeof t,function:t=>"function"==typeof t,boolean:t=>"boolean"==typeof t,string:t=>"string"==typeof t,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>"function"==typeof t&&Number.isSafeInteger(t.outputLen)};function Kn(t,e,r={}){const n=(e,r,n)=>{const i=$n[r];if("function"!=typeof i)throw new Error(`Invalid validator "${r}", expected function`);const o=t[e];if(!(n&&void 0===o||i(o,t)))throw new Error(`Invalid param ${String(e)}=${o} (${typeof o}), expected ${r}`)};for(const[t,r]of Object.entries(e))n(t,r,!1);for(const[t,e]of Object.entries(r))n(t,e,!0);return t}const jn=BigInt(0),Vn=BigInt(1),Hn=BigInt(2),zn=BigInt(3),Fn=BigInt(4),qn=BigInt(5),Wn=BigInt(8);function Jn(t,e){const r=t%e;return r>=jn?r:e+r}function Mn(t,e,r){if(r<=jn||e<jn)throw new Error("Expected power/modulo > 0");if(r===Vn)return jn;let n=Vn;for(;e>jn;)e&Vn&&(n=n*t%r),t=t*t%r,e>>=Vn;return n}function Gn(t,e,r){let n=t;for(;e-- >jn;)n*=n,n%=r;return n}function Xn(t,e){if(t===jn||e<=jn)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=Jn(t,e),n=e,i=jn,o=Vn,s=Vn,a=jn;for(;r!==jn;){const t=n/r,e=n%r,c=i-s*t,h=o-a*t;n=r,r=e,i=s,o=a,s=c,a=h}if(n!==Vn)throw new Error("invert: does not exist");return Jn(i,e)}BigInt(9),BigInt(16);const Zn=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Yn(t,e){const r=void 0!==e?e:t.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function Qn(t,e,r=!1,n={}){if(t<=jn)throw new Error(`Expected Fp ORDER > 0, got ${t}`);const{nBitLength:i,nByteLength:o}=Yn(t,e);if(o>2048)throw new Error("Field lengths over 2048 bytes are not supported");const s=function(t){if(t%Fn===zn){const e=(t+Vn)/Fn;return function(t,r){const n=t.pow(r,e);if(!t.eql(t.sqr(n),r))throw new Error("Cannot find square root");return n}}if(t%Wn===qn){const e=(t-qn)/Wn;return function(t,r){const n=t.mul(r,Hn),i=t.pow(n,e),o=t.mul(r,i),s=t.mul(t.mul(o,Hn),i),a=t.mul(o,t.sub(s,t.ONE));if(!t.eql(t.sqr(a),r))throw new Error("Cannot find square root");return a}}return function(t){const e=(t-Vn)/Hn;let r,n,i;for(r=t-Vn,n=0;r%Hn===jn;r/=Hn,n++);for(i=Hn;i<t&&Mn(i,e,t)!==t-Vn;i++);if(1===n){const e=(t+Vn)/Fn;return function(t,r){const n=t.pow(r,e);if(!t.eql(t.sqr(n),r))throw new Error("Cannot find square root");return n}}const o=(r+Vn)/Hn;return function(t,s){if(t.pow(s,e)===t.neg(t.ONE))throw new Error("Cannot find square root");let a=n,c=t.pow(t.mul(t.ONE,i),r),h=t.pow(s,o),u=t.pow(s,r);for(;!t.eql(u,t.ONE);){if(t.eql(u,t.ZERO))return t.ZERO;let e=1;for(let r=t.sqr(u);e<a&&!t.eql(r,t.ONE);e++)r=t.sqr(r);const r=t.pow(c,Vn<<BigInt(a-e-1));c=t.sqr(r),h=t.mul(h,r),u=t.mul(u,c),a=e}return h}}(t)}(t),a=Object.freeze({ORDER:t,BITS:i,BYTES:o,MASK:On(i),ZERO:jn,ONE:Vn,create:e=>Jn(e,t),isValid:e=>{if("bigint"!=typeof e)throw new Error("Invalid field element: expected bigint, got "+typeof e);return jn<=e&&e<t},is0:t=>t===jn,isOdd:t=>(t&Vn)===Vn,neg:e=>Jn(-e,t),eql:(t,e)=>t===e,sqr:e=>Jn(e*e,t),add:(e,r)=>Jn(e+r,t),sub:(e,r)=>Jn(e-r,t),mul:(e,r)=>Jn(e*r,t),pow:(t,e)=>function(t,e,r){if(r<jn)throw new Error("Expected power > 0");if(r===jn)return t.ONE;if(r===Vn)return e;let n=t.ONE,i=e;for(;r>jn;)r&Vn&&(n=t.mul(n,i)),i=t.sqr(i),r>>=Vn;return n}(a,t,e),div:(e,r)=>Jn(e*Xn(r,t),t),sqrN:t=>t*t,addN:(t,e)=>t+e,subN:(t,e)=>t-e,mulN:(t,e)=>t*e,inv:e=>Xn(e,t),sqrt:n.sqrt||(t=>s(a,t)),invertBatch:t=>function(t,e){const r=new Array(e.length),n=e.reduce(((e,n,i)=>t.is0(n)?e:(r[i]=e,t.mul(e,n))),t.ONE),i=t.inv(n);return e.reduceRight(((e,n,i)=>t.is0(n)?e:(r[i]=t.mul(e,r[i]),t.mul(e,n))),i),r}(a,t),cmov:(t,e,r)=>r?e:t,toBytes:t=>r?Bn(t,o):_n(t,o),fromBytes:t=>{if(t.length!==o)throw new Error(`Fp.fromBytes: expected ${o}, got ${t.length}`);return r?An(t):xn(t)}});return Object.freeze(a)}const ti=BigInt(0),ei=BigInt(1);function ri(t,e){const r=(t,e)=>{const r=e.negate();return t?r:e},n=t=>({windows:Math.ceil(e/t)+1,windowSize:2**(t-1)});return{constTimeNegate:r,unsafeLadder(e,r){let n=t.ZERO,i=e;for(;r>ti;)r&ei&&(n=n.add(i)),i=i.double(),r>>=ei;return n},precomputeWindow(t,e){const{windows:r,windowSize:i}=n(e),o=[];let s=t,a=s;for(let t=0;t<r;t++){a=s,o.push(a);for(let t=1;t<i;t++)a=a.add(s),o.push(a);s=a.double()}return o},wNAF(e,i,o){const{windows:s,windowSize:a}=n(e);let c=t.ZERO,h=t.BASE;const u=BigInt(2**e-1),f=2**e,d=BigInt(e);for(let t=0;t<s;t++){const e=t*a;let n=Number(o&u);o>>=d,n>a&&(n-=f,o+=ei);const s=e,l=e+Math.abs(n)-1,p=t%2!=0,y=n<0;0===n?h=h.add(r(p,i[s])):c=c.add(r(y,i[l]))}return{p:c,f:h}},wNAFCached(t,e,r,n){const i=t._WINDOW_SIZE||1;let o=e.get(t);return o||(o=this.precomputeWindow(t,i),1!==i&&e.set(t,n(o))),this.wNAF(i,o,r)}}}function ni(t){return Kn(t.Fp,Zn.reduce(((t,e)=>(t[e]="function",t)),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"})),Kn(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Yn(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const ii=BigInt(0),oi=BigInt(1),si=BigInt(2),ai=BigInt(8),ci={zip215:!0};function hi(t){const e=function(t){const e=ni(t);return Kn(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}(t),{Fp:r,n,prehash:i,hash:o,randomBytes:s,nByteLength:a,h:c}=e,h=si<<BigInt(8*a)-oi,u=r.create,f=e.uvRatio||((t,e)=>{try{return{isValid:!0,value:r.sqrt(t*r.inv(e))}}catch(t){return{isValid:!1,value:ii}}}),d=e.adjustScalarBytes||(t=>t),l=e.domain||((t,e,r)=>{if(e.length||r)throw new Error("Contexts/pre-hash are not supported");return t}),p=t=>"bigint"==typeof t&&ii<t,y=(t,e)=>p(t)&&p(e)&&t<e,w=t=>t===ii||y(t,h);function g(t,e){if(y(t,e))return t;throw new Error(`Expected valid scalar < ${e}, got ${typeof t} ${t}`)}function b(t){return t===ii?t:g(t,n)}const m=new Map;function v(t){if(!(t instanceof E))throw new Error("ExtendedPoint expected")}class E{constructor(t,e,r,n){if(this.ex=t,this.ey=e,this.ez=r,this.et=n,!w(t))throw new Error("x required");if(!w(e))throw new Error("y required");if(!w(r))throw new Error("z required");if(!w(n))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(t){if(t instanceof E)throw new Error("extended point not allowed");const{x:e,y:r}=t||{};if(!w(e)||!w(r))throw new Error("invalid affine point");return new E(e,r,oi,u(e*r))}static normalizeZ(t){const e=r.invertBatch(t.map((t=>t.ez)));return t.map(((t,r)=>t.toAffine(e[r]))).map(E.fromAffine)}_setWindowSize(t){this._WINDOW_SIZE=t,m.delete(this)}assertValidity(){const{a:t,d:r}=e;if(this.is0())throw new Error("bad point: ZERO");const{ex:n,ey:i,ez:o,et:s}=this,a=u(n*n),c=u(i*i),h=u(o*o),f=u(h*h),d=u(a*t);if(u(h*u(d+c))!==u(f+u(r*u(a*c))))throw new Error("bad point: equation left != right (1)");if(u(n*i)!==u(o*s))throw new Error("bad point: equation left != right (2)")}equals(t){v(t);const{ex:e,ey:r,ez:n}=this,{ex:i,ey:o,ez:s}=t,a=u(e*s),c=u(i*n),h=u(r*s),f=u(o*n);return a===c&&h===f}is0(){return this.equals(E.ZERO)}negate(){return new E(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){const{a:t}=e,{ex:r,ey:n,ez:i}=this,o=u(r*r),s=u(n*n),a=u(si*u(i*i)),c=u(t*o),h=r+n,f=u(u(h*h)-o-s),d=c+s,l=d-a,p=c-s,y=u(f*l),w=u(d*p),g=u(f*p),b=u(l*d);return new E(y,w,b,g)}add(t){v(t);const{a:r,d:n}=e,{ex:i,ey:o,ez:s,et:a}=this,{ex:c,ey:h,ez:f,et:d}=t;if(r===BigInt(-1)){const t=u((o-i)*(h+c)),e=u((o+i)*(h-c)),r=u(e-t);if(r===ii)return this.double();const n=u(s*si*d),l=u(a*si*f),p=l+n,y=e+t,w=l-n,g=u(p*r),b=u(y*w),m=u(p*w),v=u(r*y);return new E(g,b,v,m)}const l=u(i*c),p=u(o*h),y=u(a*n*d),w=u(s*f),g=u((i+o)*(c+h)-l-p),b=w-y,m=w+y,x=u(p-r*l),A=u(g*b),_=u(m*x),B=u(g*x),I=u(b*m);return new E(A,_,I,B)}subtract(t){return this.add(t.negate())}wNAF(t){return _.wNAFCached(this,m,t,E.normalizeZ)}multiply(t){const{p:e,f:r}=this.wNAF(g(t,n));return E.normalizeZ([e,r])[0]}multiplyUnsafe(t){let e=b(t);return e===ii?A:this.equals(A)||e===oi?this:this.equals(x)?this.wNAF(e).p:_.unsafeLadder(this,e)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return _.unsafeLadder(this,n).is0()}toAffine(t){const{ex:e,ey:n,ez:i}=this,o=this.is0();null==t&&(t=o?ai:r.inv(i));const s=u(e*t),a=u(n*t),c=u(i*t);if(o)return{x:ii,y:oi};if(c!==oi)throw new Error("invZ was invalid");return{x:s,y:a}}clearCofactor(){const{h:t}=e;return t===oi?this:this.multiplyUnsafe(t)}static fromHex(t,n=!1){const{d:i,a:o}=e,s=r.BYTES,a=(t=Sn("pointHex",t,s)).slice(),c=t[s-1];a[s-1]=-129&c;const d=An(a);d===ii||g(d,n?h:r.ORDER);const l=u(d*d),p=u(l-oi),y=u(i*l-o);let{isValid:w,value:b}=f(p,y);if(!w)throw new Error("Point.fromHex: invalid y coordinate");const m=(b&oi)===oi,v=0!=(128&c);if(!n&&b===ii&&v)throw new Error("Point.fromHex: x=0 and x_0=1");return v!==m&&(b=u(-b)),E.fromAffine({x:b,y:d})}static fromPrivateKey(t){return S(t).point}toRawBytes(){const{x:t,y:e}=this.toAffine(),n=Bn(e,r.BYTES);return n[n.length-1]|=t&oi?128:0,n}toHex(){return bn(this.toRawBytes())}}E.BASE=new E(e.Gx,e.Gy,oi,u(e.Gx*e.Gy)),E.ZERO=new E(ii,oi,oi,ii);const{BASE:x,ZERO:A}=E,_=ri(E,8*a);function B(t){return Jn(t,n)}function I(t){return B(An(t))}function S(t){const e=a;t=Sn("private key",t,e);const r=Sn("hashed private key",o(t),2*e),n=d(r.slice(0,e)),i=r.slice(e,2*e),s=I(n),c=x.multiply(s),h=c.toRawBytes();return{head:n,prefix:i,scalar:s,point:c,pointBytes:h}}function U(t=new Uint8Array,...e){const r=Un(...e);return I(o(l(r,Sn("context",t),!!i)))}const P=ci;return x._setWindowSize(8),{CURVE:e,getPublicKey:function(t){return S(t).pointBytes},sign:function(t,e,n={}){t=Sn("message",t),i&&(t=i(t));const{prefix:o,scalar:s,pointBytes:c}=S(e),h=U(n.context,o,t),u=x.multiply(h).toRawBytes(),f=B(h+U(n.context,u,c,t)*s);return b(f),Sn("result",Un(u,Bn(f,r.BYTES)),2*a)},verify:function(t,e,n,o=P){const{context:s,zip215:a}=o,c=r.BYTES;t=Sn("signature",t,2*c),e=Sn("message",e),i&&(e=i(e));const h=An(t.slice(c,2*c));let u,f,d;try{u=E.fromHex(n,a),f=E.fromHex(t.slice(0,c),a),d=x.multiplyUnsafe(h)}catch(t){return!1}if(!a&&u.isSmallOrder())return!1;const l=U(s,f.toRawBytes(),u.toRawBytes(),e);return f.add(u.multiplyUnsafe(l)).subtract(d).clearCofactor().equals(E.ZERO)},ExtendedPoint:E,utils:{getExtendedPublicKey:S,randomPrivateKey:()=>s(r.BYTES),precompute:(t=8,e=E.BASE)=>(e._setWindowSize(t),e.multiply(BigInt(3)),e)}}}const ui=BigInt(0),fi=BigInt(1);const di=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),li=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),pi=(BigInt(0),BigInt(1)),yi=BigInt(2),wi=BigInt(5),gi=BigInt(10),bi=BigInt(20),mi=BigInt(40),vi=BigInt(80);function Ei(t){const e=di,r=t*t%e*t%e,n=Gn(r,yi,e)*r%e,i=Gn(n,pi,e)*t%e,o=Gn(i,wi,e)*i%e,s=Gn(o,gi,e)*o%e,a=Gn(s,bi,e)*s%e,c=Gn(a,mi,e)*a%e,h=Gn(c,vi,e)*c%e,u=Gn(h,vi,e)*c%e,f=Gn(u,gi,e)*o%e;return{pow_p_5_8:Gn(f,yi,e)*t%e,b2:r}}function xi(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}const Ai=Qn(di,void 0,!0),_i={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Ai,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:dn,randomBytes:Or,adjustScalarBytes:xi,uvRatio:function(t,e){const r=di,n=Jn(e*e*e,r),i=Jn(n*n*e,r);let o=Jn(t*n*Ei(t*i).pow_p_5_8,r);const s=Jn(e*o*o,r),a=o,c=Jn(o*li,r),h=s===t,u=s===Jn(-t,r),f=s===Jn(-t*li,r);return h&&(o=a),(u||f)&&(o=c),(Jn(o,r)&Vn)===Vn&&(o=Jn(-o,r)),{isValid:h||u,value:o}}},Bi=hi(_i);function Ii(t,e,r){if(e.length>255)throw new Error("Context is too big");return Lr(Pr("SigEd25519 no Ed25519 collisions"),new Uint8Array([r?1:0,e.length]),e,t)}hi({..._i,domain:Ii}),hi({..._i,domain:Ii,prehash:dn});const Si=(()=>function(t){const e=(Kn(r=t,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...r}));var r;const{P:n}=e,i=t=>Jn(t,n),o=e.montgomeryBits,s=Math.ceil(o/8),a=e.nByteLength,c=e.adjustScalarBytes||(t=>t),h=e.powPminus2||(t=>Mn(t,n-BigInt(2),n));function u(t,e,r){const n=i(t*(e-r));return[e=i(e-n),r=i(r+n)]}function f(t){if("bigint"==typeof t&&ui<=t&&t<n)return t;throw new Error("Expected valid scalar 0 < scalar < CURVE.P")}const d=(e.a-BigInt(2))/BigInt(4);function l(t){return Bn(i(t),s)}function p(t,e){const r=function(t){const e=Sn("u coordinate",t,s);return a===s&&(e[a-1]&=127),An(e)}(e),n=function(t){const e=Sn("scalar",t);if(e.length!==s&&e.length!==a)throw new Error(`Expected ${s} or ${a} bytes, got ${e.length}`);return An(c(e))}(t),p=function(t,e){const r=f(t),n=f(e),s=r;let a,c=fi,l=ui,p=r,y=fi,w=ui;for(let t=BigInt(o-1);t>=ui;t--){const e=n>>t&fi;w^=e,a=u(w,c,p),c=a[0],p=a[1],a=u(w,l,y),l=a[0],y=a[1],w=e;const r=c+l,o=i(r*r),h=c-l,f=i(h*h),g=o-f,b=p+y,m=i((p-y)*r),v=i(b*h),E=m+v,x=m-v;p=i(E*E),y=i(s*i(x*x)),c=i(o*f),l=i(g*(o+i(d*g)))}a=u(w,c,p),c=a[0],p=a[1],a=u(w,l,y),l=a[0],y=a[1];const g=h(l);return i(c*g)}(r,n);if(p===ui)throw new Error("Invalid private or public key received");return l(p)}const y=l(e.Gu);function w(t){return p(t,y)}return{scalarMult:p,scalarMultBase:w,getSharedSecret:(t,e)=>p(t,e),getPublicKey:t=>w(t),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:y}}({P:di,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:t=>{const e=di,{pow_p_5_8:r,b2:n}=Ei(t);return Jn(Gn(r,BigInt(3),e)*n,e)},adjustScalarBytes:xi,randomBytes:Or}))(),Ui=(Ai.ORDER+BigInt(3))/BigInt(8);Ai.pow(yi,Ui),Ai.sqrt(Ai.neg(Ai.ONE)),Ai.ORDER,BigInt(5),BigInt(8),BigInt(486662),function(t,e){if(!t.isOdd)throw new Error("Field doesn't have isOdd");const r=t.sqrt(e);t.isOdd(r)&&t.neg(r)}(Ai,Ai.neg(BigInt(486664))),BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");const Pi=(t,e,r)=>t&e^t&r^e&r,Ci=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Li=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Di=new Uint32Array(64);class ki extends Tr{constructor(){super(64,32,8,!1),this.A=0|Li[0],this.B=0|Li[1],this.C=0|Li[2],this.D=0|Li[3],this.E=0|Li[4],this.F=0|Li[5],this.G=0|Li[6],this.H=0|Li[7]}get(){const{A:t,B:e,C:r,D:n,E:i,F:o,G:s,H:a}=this;return[t,e,r,n,i,o,s,a]}set(t,e,r,n,i,o,s,a){this.A=0|t,this.B=0|e,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|o,this.G=0|s,this.H=0|a}process(t,e){for(let r=0;r<16;r++,e+=4)Di[r]=t.getUint32(e,!1);for(let t=16;t<64;t++){const e=Di[t-15],r=Di[t-2],n=Ur(e,7)^Ur(e,18)^e>>>3,i=Ur(r,17)^Ur(r,19)^r>>>10;Di[t]=i+Di[t-7]+n+Di[t-16]|0}let{A:r,B:n,C:i,D:o,E:s,F:a,G:c,H:h}=this;for(let t=0;t<64;t++){const e=h+(Ur(s,6)^Ur(s,11)^Ur(s,25))+((u=s)&a^~u&c)+Ci[t]+Di[t]|0,f=(Ur(r,2)^Ur(r,13)^Ur(r,22))+Pi(r,n,i)|0;h=c,c=a,a=s,s=o+e|0,o=i,i=n,n=r,r=e+f|0}var u;r=r+this.A|0,n=n+this.B|0,i=i+this.C|0,o=o+this.D|0,s=s+this.E|0,a=a+this.F|0,c=c+this.G|0,h=h+this.H|0,this.set(r,n,i,o,s,a,c,h)}roundClean(){Di.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class Oi extends ki{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const Ti=kr((()=>new ki)),Ni=(kr((()=>new Oi)),new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8])),Ri=Uint8Array.from({length:16},((t,e)=>e)),$i=Ri.map((t=>(9*t+5)%16));let Ki=[Ri],ji=[$i];for(let t=0;t<4;t++)for(let e of[Ki,ji])e.push(e[t].map((t=>Ni[t])));const Vi=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map((t=>new Uint8Array(t))),Hi=Ki.map(((t,e)=>t.map((t=>Vi[e][t])))),zi=ji.map(((t,e)=>t.map((t=>Vi[e][t])))),Fi=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),qi=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]),Wi=(t,e)=>t<<e|t>>>32-e;function Ji(t,e,r,n){return 0===t?e^r^n:1===t?e&r|~e&n:2===t?(e|~r)^n:3===t?e&n|r&~n:e^(r|~n)}const Mi=new Uint32Array(16);class Gi extends Tr{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:t,h1:e,h2:r,h3:n,h4:i}=this;return[t,e,r,n,i]}set(t,e,r,n,i){this.h0=0|t,this.h1=0|e,this.h2=0|r,this.h3=0|n,this.h4=0|i}process(t,e){for(let r=0;r<16;r++,e+=4)Mi[r]=t.getUint32(e,!0);let r=0|this.h0,n=r,i=0|this.h1,o=i,s=0|this.h2,a=s,c=0|this.h3,h=c,u=0|this.h4,f=u;for(let t=0;t<5;t++){const e=4-t,d=Fi[t],l=qi[t],p=Ki[t],y=ji[t],w=Hi[t],g=zi[t];for(let e=0;e<16;e++){const n=Wi(r+Ji(t,i,s,c)+Mi[p[e]]+d,w[e])+u|0;r=u,u=c,c=0|Wi(s,10),s=i,i=n}for(let t=0;t<16;t++){const r=Wi(n+Ji(e,o,a,h)+Mi[y[t]]+l,g[t])+f|0;n=f,f=h,h=0|Wi(a,10),a=o,o=r}}this.set(this.h1+s+h|0,this.h2+c+f|0,this.h3+u+n|0,this.h4+r+o|0,this.h0+i+a|0)}roundClean(){Mi.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}}const Xi=kr((()=>new Gi)),[Zi,Yi,Qi]=[[],[],[]],to=BigInt(0),eo=BigInt(1),ro=BigInt(2),no=BigInt(7),io=BigInt(256),oo=BigInt(113);for(let t=0,e=eo,r=1,n=0;t<24;t++){[r,n]=[n,(2*r+3*n)%5],Zi.push(2*(5*n+r)),Yi.push((t+1)*(t+2)/2%64);let i=to;for(let t=0;t<7;t++)e=(e<<eo^(e>>no)*oo)%io,e&ro&&(i^=eo<<(eo<<BigInt(t))-eo);Qi.push(i)}const[so,ao]=Kr(Qi,!0),co=(t,e,r)=>r>32?Mr(t,e,r):Wr(t,e,r),ho=(t,e,r)=>r>32?Gr(t,e,r):Jr(t,e,r);class uo extends Dr{constructor(t,e,r,n=!1,i=24){if(super(),this.blockLen=t,this.suffix=e,this.outputLen=r,this.enableXOF=n,this.rounds=i,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,_r.number(r),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");var o;this.state=new Uint8Array(200),this.state32=(o=this.state,new Uint32Array(o.buffer,o.byteOffset,Math.floor(o.byteLength/4)))}keccak(){!function(t,e=24){const r=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let e=0;e<10;e++)r[e]=t[e]^t[e+10]^t[e+20]^t[e+30]^t[e+40];for(let e=0;e<10;e+=2){const n=(e+8)%10,i=(e+2)%10,o=r[i],s=r[i+1],a=co(o,s,1)^r[n],c=ho(o,s,1)^r[n+1];for(let r=0;r<50;r+=10)t[e+r]^=a,t[e+r+1]^=c}let e=t[2],i=t[3];for(let r=0;r<24;r++){const n=Yi[r],o=co(e,i,n),s=ho(e,i,n),a=Zi[r];e=t[a],i=t[a+1],t[a]=o,t[a+1]=s}for(let e=0;e<50;e+=10){for(let n=0;n<10;n++)r[n]=t[e+n];for(let n=0;n<10;n++)t[e+n]^=~r[(n+2)%10]&r[(n+4)%10]}t[0]^=so[n],t[1]^=ao[n]}r.fill(0)}(this.state32,this.rounds),this.posOut=0,this.pos=0}update(t){_r.exists(this);const{blockLen:e,state:r}=this,n=(t=Cr(t)).length;for(let i=0;i<n;){const o=Math.min(e-this.pos,n-i);for(let e=0;e<o;e++)r[this.pos++]^=t[i++];this.pos===e&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:e,pos:r,blockLen:n}=this;t[r]^=e,0!=(128&e)&&r===n-1&&this.keccak(),t[n-1]^=128,this.keccak()}writeInto(t){_r.exists(this,!1),_r.bytes(t),this.finish();const e=this.state,{blockLen:r}=this;for(let n=0,i=t.length;n<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-n);t.set(e.subarray(this.posOut,this.posOut+o),n),this.posOut+=o,n+=o}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return _r.number(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(_r.output(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){const{blockLen:e,suffix:r,outputLen:n,rounds:i,enableXOF:o}=this;return t||(t=new uo(e,r,n,o,i)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=i,t.suffix=r,t.outputLen=n,t.enableXOF=o,t.destroyed=this.destroyed,t}}const fo=(t,e,r)=>kr((()=>new uo(e,t,r))),lo=(fo(6,144,28),fo(6,136,32),fo(6,104,48),fo(6,72,64),fo(1,144,28),fo(1,136,32)),po=(fo(1,104,48),fo(1,72,64),(t,e,r)=>function(t){const e=(e,r)=>t(r).update(Cr(e)).digest(),r=t({});return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=e=>t(e),e}(((n={})=>new uo(e,t,void 0===n.dkLen?r:n.dkLen,!0))));po(31,168,16),po(31,136,32);const{bytesToNumberBE:yo,hexToBytes:wo}=C,go={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(t){const{Err:e}=go;if(t.length<2||2!==t[0])throw new e("Invalid signature integer tag");const r=t[1],n=t.subarray(2,r+2);if(!r||n.length!==r)throw new e("Invalid signature integer: wrong length");if(128&n[0])throw new e("Invalid signature integer: negative");if(0===n[0]&&!(128&n[1]))throw new e("Invalid signature integer: unnecessary leading zero");return{d:yo(n),l:t.subarray(r+2)}},toSig(t){const{Err:e}=go,r="string"==typeof t?wo(t):t;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");let n=r.length;if(n<2||48!=r[0])throw new e("Invalid signature tag");if(r[1]!==n-2)throw new e("Invalid signature: incorrect length");const{d:i,l:o}=go._parseInt(r.subarray(2)),{d:s,l:a}=go._parseInt(o);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:i,s}},hexFromSig(t){const e=t=>8&Number.parseInt(t[0],16)?"00"+t:t,r=t=>{const e=t.toString(16);return 1&e.length?`0${e}`:e},n=e(r(t.s)),i=e(r(t.r)),o=n.length/2,s=i.length/2,a=r(o),c=r(s);return`30${r(s+o+4)}02${c}${i}02${a}${n}`}},bo=BigInt(0),mo=BigInt(1),vo=(BigInt(2),BigInt(3));function Eo(t){const e=function(t){const e=ni(t);return Kn(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}(t),{Fp:r,n}=e,i=r.BYTES+1,o=2*r.BYTES+1;function s(t){return Jn(t,n)}function a(t){return Xn(t,n)}const{ProjectivePoint:c,normPrivateKeyToScalar:h,weierstrassEquation:u,isWithinCurveOrder:f}=function(t){const e=function(t){const e=ni(t);Kn(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:r,Fp:n,a:i}=e;if(r){if(!n.eql(i,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!=typeof r||"bigint"!=typeof r.beta||"function"!=typeof r.splitScalar)throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}(t),{Fp:r}=e,n=e.toBytes||((t,e,n)=>{const i=e.toAffine();return Un(Uint8Array.from([4]),r.toBytes(i.x),r.toBytes(i.y))}),i=e.fromBytes||(t=>{const e=t.subarray(1);return{x:r.fromBytes(e.subarray(0,r.BYTES)),y:r.fromBytes(e.subarray(r.BYTES,2*r.BYTES))}});function o(t){const{a:n,b:i}=e,o=r.sqr(t),s=r.mul(o,t);return r.add(r.add(s,r.mul(t,n)),i)}if(!r.eql(r.sqr(e.Gy),o(e.Gx)))throw new Error("bad generator point: equation left != right");function s(t){return"bigint"==typeof t&&bo<t&&t<e.n}function a(t){if(!s(t))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(t){const{allowedPrivateKeyLengths:r,nByteLength:n,wrapPrivateKey:i,n:o}=e;if(r&&"bigint"!=typeof t){if(t instanceof Uint8Array&&(t=bn(t)),"string"!=typeof t||!r.includes(t.length))throw new Error("Invalid key");t=t.padStart(2*n,"0")}let s;try{s="bigint"==typeof t?t:xn(Sn("private key",t,n))}catch(e){throw new Error(`private key must be ${n} bytes, hex or bigint, not ${typeof t}`)}return i&&(s=Jn(s,o)),a(s),s}const h=new Map;function u(t){if(!(t instanceof f))throw new Error("ProjectivePoint expected")}class f{constructor(t,e,n){if(this.px=t,this.py=e,this.pz=n,null==t||!r.isValid(t))throw new Error("x required");if(null==e||!r.isValid(e))throw new Error("y required");if(null==n||!r.isValid(n))throw new Error("z required")}static fromAffine(t){const{x:e,y:n}=t||{};if(!t||!r.isValid(e)||!r.isValid(n))throw new Error("invalid affine point");if(t instanceof f)throw new Error("projective point not allowed");const i=t=>r.eql(t,r.ZERO);return i(e)&&i(n)?f.ZERO:new f(e,n,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(t){const e=r.invertBatch(t.map((t=>t.pz)));return t.map(((t,r)=>t.toAffine(e[r]))).map(f.fromAffine)}static fromHex(t){const e=f.fromAffine(i(Sn("pointHex",t)));return e.assertValidity(),e}static fromPrivateKey(t){return f.BASE.multiply(c(t))}_setWindowSize(t){this._WINDOW_SIZE=t,h.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint)return;throw new Error("bad point: ZERO")}const{x:t,y:n}=this.toAffine();if(!r.isValid(t)||!r.isValid(n))throw new Error("bad point: x or y not FE");const i=r.sqr(n),s=o(t);if(!r.eql(i,s))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:t}=this.toAffine();if(r.isOdd)return!r.isOdd(t);throw new Error("Field doesn't support isOdd")}equals(t){u(t);const{px:e,py:n,pz:i}=this,{px:o,py:s,pz:a}=t,c=r.eql(r.mul(e,a),r.mul(o,i)),h=r.eql(r.mul(n,a),r.mul(s,i));return c&&h}negate(){return new f(this.px,r.neg(this.py),this.pz)}double(){const{a:t,b:n}=e,i=r.mul(n,vo),{px:o,py:s,pz:a}=this;let c=r.ZERO,h=r.ZERO,u=r.ZERO,d=r.mul(o,o),l=r.mul(s,s),p=r.mul(a,a),y=r.mul(o,s);return y=r.add(y,y),u=r.mul(o,a),u=r.add(u,u),c=r.mul(t,u),h=r.mul(i,p),h=r.add(c,h),c=r.sub(l,h),h=r.add(l,h),h=r.mul(c,h),c=r.mul(y,c),u=r.mul(i,u),p=r.mul(t,p),y=r.sub(d,p),y=r.mul(t,y),y=r.add(y,u),u=r.add(d,d),d=r.add(u,d),d=r.add(d,p),d=r.mul(d,y),h=r.add(h,d),p=r.mul(s,a),p=r.add(p,p),d=r.mul(p,y),c=r.sub(c,d),u=r.mul(p,l),u=r.add(u,u),u=r.add(u,u),new f(c,h,u)}add(t){u(t);const{px:n,py:i,pz:o}=this,{px:s,py:a,pz:c}=t;let h=r.ZERO,d=r.ZERO,l=r.ZERO;const p=e.a,y=r.mul(e.b,vo);let w=r.mul(n,s),g=r.mul(i,a),b=r.mul(o,c),m=r.add(n,i),v=r.add(s,a);m=r.mul(m,v),v=r.add(w,g),m=r.sub(m,v),v=r.add(n,o);let E=r.add(s,c);return v=r.mul(v,E),E=r.add(w,b),v=r.sub(v,E),E=r.add(i,o),h=r.add(a,c),E=r.mul(E,h),h=r.add(g,b),E=r.sub(E,h),l=r.mul(p,v),h=r.mul(y,b),l=r.add(h,l),h=r.sub(g,l),l=r.add(g,l),d=r.mul(h,l),g=r.add(w,w),g=r.add(g,w),b=r.mul(p,b),v=r.mul(y,v),g=r.add(g,b),b=r.sub(w,b),b=r.mul(p,b),v=r.add(v,b),w=r.mul(g,v),d=r.add(d,w),w=r.mul(E,v),h=r.mul(m,h),h=r.sub(h,w),w=r.mul(m,g),l=r.mul(E,l),l=r.add(l,w),new f(h,d,l)}subtract(t){return this.add(t.negate())}is0(){return this.equals(f.ZERO)}wNAF(t){return l.wNAFCached(this,h,t,(t=>{const e=r.invertBatch(t.map((t=>t.pz)));return t.map(((t,r)=>t.toAffine(e[r]))).map(f.fromAffine)}))}multiplyUnsafe(t){const n=f.ZERO;if(t===bo)return n;if(a(t),t===mo)return this;const{endo:i}=e;if(!i)return l.unsafeLadder(this,t);let{k1neg:o,k1:s,k2neg:c,k2:h}=i.splitScalar(t),u=n,d=n,p=this;for(;s>bo||h>bo;)s&mo&&(u=u.add(p)),h&mo&&(d=d.add(p)),p=p.double(),s>>=mo,h>>=mo;return o&&(u=u.negate()),c&&(d=d.negate()),d=new f(r.mul(d.px,i.beta),d.py,d.pz),u.add(d)}multiply(t){a(t);let n,i,o=t;const{endo:s}=e;if(s){const{k1neg:t,k1:e,k2neg:a,k2:c}=s.splitScalar(o);let{p:h,f:u}=this.wNAF(e),{p:d,f:p}=this.wNAF(c);h=l.constTimeNegate(t,h),d=l.constTimeNegate(a,d),d=new f(r.mul(d.px,s.beta),d.py,d.pz),n=h.add(d),i=u.add(p)}else{const{p:t,f:e}=this.wNAF(o);n=t,i=e}return f.normalizeZ([n,i])[0]}multiplyAndAddUnsafe(t,e,r){const n=f.BASE,i=(t,e)=>e!==bo&&e!==mo&&t.equals(n)?t.multiply(e):t.multiplyUnsafe(e),o=i(this,e).add(i(t,r));return o.is0()?void 0:o}toAffine(t){const{px:e,py:n,pz:i}=this,o=this.is0();null==t&&(t=o?r.ONE:r.inv(i));const s=r.mul(e,t),a=r.mul(n,t),c=r.mul(i,t);if(o)return{x:r.ZERO,y:r.ZERO};if(!r.eql(c,r.ONE))throw new Error("invZ was invalid");return{x:s,y:a}}isTorsionFree(){const{h:t,isTorsionFree:r}=e;if(t===mo)return!0;if(r)return r(f,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:t,clearCofactor:r}=e;return t===mo?this:r?r(f,this):this.multiplyUnsafe(e.h)}toRawBytes(t=!0){return this.assertValidity(),n(f,this,t)}toHex(t=!0){return bn(this.toRawBytes(t))}}f.BASE=new f(e.Gx,e.Gy,r.ONE),f.ZERO=new f(r.ZERO,r.ONE,r.ZERO);const d=e.nBitLength,l=ri(f,e.endo?Math.ceil(d/2):d);return{CURVE:e,ProjectivePoint:f,normPrivateKeyToScalar:c,weierstrassEquation:o,isWithinCurveOrder:s}}({...e,toBytes(t,e,n){const i=e.toAffine(),o=r.toBytes(i.x),s=Un;return n?s(Uint8Array.from([e.hasEvenY()?2:3]),o):s(Uint8Array.from([4]),o,r.toBytes(i.y))},fromBytes(t){const e=t.length,n=t[0],s=t.subarray(1);if(e!==i||2!==n&&3!==n){if(e===o&&4===n)return{x:r.fromBytes(s.subarray(0,r.BYTES)),y:r.fromBytes(s.subarray(r.BYTES,2*r.BYTES))};throw new Error(`Point of length ${e} was invalid. Expected ${i} compressed bytes or ${o} uncompressed bytes`)}{const t=xn(s);if(!(bo<(a=t)&&a<r.ORDER))throw new Error("Point is not on curve");const e=u(t);let i=r.sqrt(e);return 1==(1&n)!=((i&mo)===mo)&&(i=r.neg(i)),{x:t,y:i}}var a}}),d=t=>bn(_n(t,e.nByteLength));function l(t){return t>n>>mo}const p=(t,e,r)=>xn(t.slice(e,r));class y{constructor(t,e,r){this.r=t,this.s=e,this.recovery=r,this.assertValidity()}static fromCompact(t){const r=e.nByteLength;return t=Sn("compactSignature",t,2*r),new y(p(t,0,r),p(t,r,2*r))}static fromDER(t){const{r:e,s:r}=go.toSig(Sn("DER",t));return new y(e,r)}assertValidity(){if(!f(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!f(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(t){return new y(this.r,this.s,t)}recoverPublicKey(t){const{r:n,s:i,recovery:o}=this,h=m(Sn("msgHash",t));if(null==o||![0,1,2,3].includes(o))throw new Error("recovery id invalid");const u=2===o||3===o?n+e.n:n;if(u>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");const f=0==(1&o)?"02":"03",l=c.fromHex(f+d(u)),p=a(u),y=s(-h*p),w=s(i*p),g=c.BASE.multiplyAndAddUnsafe(l,y,w);if(!g)throw new Error("point at infinify");return g.assertValidity(),g}hasHighS(){return l(this.s)}normalizeS(){return this.hasHighS()?new y(this.r,s(-this.s),this.recovery):this}toDERRawBytes(){return En(this.toDERHex())}toDERHex(){return go.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return En(this.toCompactHex())}toCompactHex(){return d(this.r)+d(this.s)}}const w={isValidPrivateKey(t){try{return h(t),!0}catch(t){return!1}},normPrivateKeyToScalar:h,randomPrivateKey:()=>_n(function(t,e,r=!1){const n=(t=Sn("privateHash",t)).length,i=Yn(e).nByteLength+8;if(i<24||n<i||n>1024)throw new Error(`hashToPrivateScalar: expected ${i}-1024 bytes of input, got ${n}`);return Jn(r?An(t):xn(t),e-Vn)+Vn}(e.randomBytes(r.BYTES+8),n),e.nByteLength),precompute:(t=8,e=c.BASE)=>(e._setWindowSize(t),e.multiply(BigInt(3)),e)};function g(t){const e=t instanceof Uint8Array,r="string"==typeof t,n=(e||r)&&t.length;return e?n===i||n===o:r?n===2*i||n===2*o:t instanceof c}const b=e.bits2int||function(t){const r=xn(t),n=8*t.length-e.nBitLength;return n>0?r>>BigInt(n):r},m=e.bits2int_modN||function(t){return s(b(t))},v=On(e.nBitLength);function E(t){if("bigint"!=typeof t)throw new Error("bigint expected");if(!(bo<=t&&t<v))throw new Error(`bigint expected < 2^${e.nBitLength}`);return _n(t,e.nByteLength)}const x={lowS:e.lowS,prehash:!1},A={lowS:e.lowS,prehash:!1};return c.BASE._setWindowSize(8),{CURVE:e,getPublicKey:function(t,e=!0){return c.fromPrivateKey(t).toRawBytes(e)},getSharedSecret:function(t,e,r=!0){if(g(t))throw new Error("first arg must be private key");if(!g(e))throw new Error("second arg must be public key");return c.fromHex(e).multiply(h(t)).toRawBytes(r)},sign:function(t,n,i=x){const{seed:o,k2sig:u}=function(t,n,i=x){if(["recovered","canonical"].some((t=>t in i)))throw new Error("sign() legacy options not supported");const{hash:o,randomBytes:u}=e;let{lowS:d,prehash:p,extraEntropy:w}=i;null==d&&(d=!0),t=Sn("msgHash",t),p&&(t=Sn("prehashed msgHash",o(t)));const g=m(t),v=h(n),A=[E(v),E(g)];if(null!=w){const t=!0===w?u(r.BYTES):w;A.push(Sn("extraEntropy",t,r.BYTES))}const _=Un(...A),B=g;return{seed:_,k2sig:function(t){const e=b(t);if(!f(e))return;const r=a(e),n=c.BASE.multiply(e).toAffine(),i=s(n.x);if(i===bo)return;const o=s(r*s(B+i*v));if(o===bo)return;let h=(n.x===i?0:2)|Number(n.y&mo),u=o;return d&&l(o)&&(u=function(t){return l(t)?s(-t):t}(o),h^=1),new y(i,u,h)}}}(t,n,i),d=e;return Rn(d.hash.outputLen,d.nByteLength,d.hmac)(o,u)},verify:function(t,r,n,i=A){const o=t;if(r=Sn("msgHash",r),n=Sn("publicKey",n),"strict"in i)throw new Error("options.strict was renamed to lowS");const{lowS:h,prehash:u}=i;let f,d;try{if("string"==typeof o||o instanceof Uint8Array)try{f=y.fromDER(o)}catch(t){if(!(t instanceof go.Err))throw t;f=y.fromCompact(o)}else{if("object"!=typeof o||"bigint"!=typeof o.r||"bigint"!=typeof o.s)throw new Error("PARSE");{const{r:t,s:e}=o;f=new y(t,e)}}d=c.fromHex(n)}catch(t){if("PARSE"===t.message)throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(h&&f.hasHighS())return!1;u&&(r=e.hash(r));const{r:l,s:p}=f,w=m(r),g=a(p),b=s(w*g),v=s(l*g),E=c.BASE.multiplyAndAddUnsafe(d,b,v)?.toAffine();return!!E&&s(E.x)===l},ProjectivePoint:c,Signature:y,utils:w}}BigInt(4);class xo extends Dr{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,_r.hash(t);const r=Cr(e);if(this.iHash=t.create(),"function"!=typeof this.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,i=new Uint8Array(n);i.set(r.length>n?t.create().update(r).digest():r);for(let t=0;t<i.length;t++)i[t]^=54;this.iHash.update(i),this.oHash=t.create();for(let t=0;t<i.length;t++)i[t]^=106;this.oHash.update(i),i.fill(0)}update(t){return _r.exists(this),this.iHash.update(t),this}digestInto(t){_r.exists(this),_r.bytes(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:r,finished:n,destroyed:i,blockLen:o,outputLen:s}=this;return t.finished=n,t.destroyed=i,t.blockLen=o,t.outputLen=s,t.oHash=e._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Ao=(t,e,r)=>new xo(t,e).update(r).digest();function _o(t){return{hash:t,hmac:(e,...r)=>Ao(t,e,Lr(...r)),randomBytes:Or}}function Bo(t,e){const r=e=>Eo({...t,..._o(e)});return Object.freeze({...r(e),create:r})}Ao.create=(t,e)=>new xo(t,e);const Io=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),So=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Uo=BigInt(1),Po=BigInt(2),Co=(t,e)=>(t+e/Po)/e;const Lo=Qn(Io,void 0,void 0,{sqrt:function(t){const e=Io,r=BigInt(3),n=BigInt(6),i=BigInt(11),o=BigInt(22),s=BigInt(23),a=BigInt(44),c=BigInt(88),h=t*t*t%e,u=h*h*t%e,f=Gn(u,r,e)*u%e,d=Gn(f,r,e)*u%e,l=Gn(d,Po,e)*h%e,p=Gn(l,i,e)*l%e,y=Gn(p,o,e)*p%e,w=Gn(y,a,e)*y%e,g=Gn(w,c,e)*w%e,b=Gn(g,a,e)*y%e,m=Gn(b,r,e)*u%e,v=Gn(m,s,e)*p%e,E=Gn(v,n,e)*h%e,x=Gn(E,Po,e);if(!Lo.eql(Lo.sqr(x),t))throw new Error("Cannot find square root");return x}}),Do=Bo({a:BigInt(0),b:BigInt(7),Fp:Lo,n:So,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=So,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-Uo*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=r,s=BigInt("0x100000000000000000000000000000000"),a=Co(o*t,e),c=Co(-n*t,e);let h=Jn(t-a*r-c*i,e),u=Jn(-a*n-c*o,e);const f=h>s,d=u>s;if(f&&(h=e-h),d&&(u=e-u),h>s||u>s)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:f,k1:h,k2neg:d,k2:u}}}},Ti);BigInt(0),Do.ProjectivePoint;const ko=Qn(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),Oo=Bo({a:ko.create(BigInt("-3")),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Fp:ko,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},Ti);var To=r(456);const No="(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))",Ro="[a-zA-Z0-9_.:%-]",$o=new RegExp(`^did:([a-z0-9]+):((?:${No}*:)*(${No}+))((;${Ro}+=${Ro}*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$`);var Ko=r(715),jo=r(375);const Vo={toString:ne,fromString:re,concat:k};function Ho(t){return Vo.toString(t,"base64url")}function zo(t){const e=t.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"");return Vo.fromString(e,"base64url")}function Fo(t){return Vo.fromString(t,"base58btc")}function qo(t,e){let r=t.startsWith("0x")?t.substring(2):t;if(r.length%2!=0&&(r=`0${r}`),e){const t=Math.max(r.length,2*e);r=r.padStart(t,"00")}return Vo.fromString(r.toLowerCase(),"base16")}function Wo(t){return Ho(Vo.fromString(t))}function Jo(t){return Vo.toString(zo(t))}function Mo(t){return Vo.toString(t,"base16")}function Go(t){return BigInt("0x"+Vo.toString(t,"base16"))}function Xo(t){return Vo.fromString(t)}function Zo({r:t,s:e,recoveryParam:r},n){const i=new Uint8Array(n?65:64);if(i.set(Vo.fromString(t,"base16"),0),i.set(Vo.fromString(e,"base16"),32),n){if(void 0===r)throw new Error("Signer did not return a recoveryParam");i[64]=r}return Ho(i)}function Yo(t){const e=zo(t);if(e.length<64||e.length>65)throw new TypeError(`Wrong size for signature. Expected 64 or 65 bytes, but got ${e.length}`);return{r:Mo(e.slice(0,32)),s:Mo(e.slice(32,64)),recoveryParam:65===e.length?e[64]:void 0}}function Qo(t,e){return Vo.concat([zo(t),e?zo(e):new Uint8Array(0)])}function ts(t,e=64){return t.length===e?t:"0".repeat(e-t.length)+t}function es(){const t=Si.utils.randomPrivateKey();return{secretKey:t,publicKey:Si.getPublicKey(t)}}function rs(t){if(32!==t.length)throw new Error("x25519: seed must be 32 bytes");return{publicKey:Si.getPublicKey(t),secretKey:t}}function ns(){const t=es();return{publicKeyJWK:{kty:"OKP",crv:"X25519",x:Ho(t.publicKey)},secretKey:t.secretKey}}function is(t){const e="string"==typeof t?re(t):t;return Ti(e)}const os=lo;function ss(t){const e=re(t.slice(2),"base16");return`0x${ne(os(e).slice(-20),"base16")}`}function as(t,e=new Uint8Array(4)){const r=re(t.toString(),"base10");return e.set(r,4-r.length),e}const cs=t=>k([as(t.length),t]);function hs(t,e,r,n,i){if(256!==e)throw new Error(`Unsupported key length: ${e}`);const o=k([cs(re(r)),cs(void 0===n?new Uint8Array(0):n),cs(void 0===i?new Uint8Array(0):i),as(e)]);return is(k([as(1),t,o]))}function us(t,e=!1){const r=t;if(32!==r.length)throw new Error(`bad_key: Invalid private key format. Expecting 32 bytes, but got ${r.length}`);return function(t){try{const n=Do.sign(is(t),r);return Promise.resolve(Zo({r:ts(n.r.toString(16)),s:ts(n.s.toString(16)),recoveryParam:n.recovery},e))}catch(t){return Promise.reject(t)}}}function fs(t){const e=us(qo(t),!0);return function(t){try{return Promise.resolve(e(t)).then(Yo)}catch(t){return Promise.reject(t)}}}function ds(t){return us(qo(t))}function ls(t){const e=t;if(64!==e.length)throw new Error(`bad_key: Invalid private key format. Expecting 64 bytes, but got ${e.length}`);return function(t){try{const r="string"==typeof t?Xo(t):t,n=Bi.sign(r,e.slice(0,32));return Promise.resolve(Ho(n))}catch(t){return Promise.reject(t)}}}function ps(t){return ls(zo(t))}function ys(t){if(32!==t.length)throw new Error(`bad_key: Invalid private key format. Expecting 32 bytes, but got ${t.length}`);return function(e){try{const r=Oo.sign(is(e),t);return Promise.resolve(Zo({r:ts(r.r.toString(16)),s:ts(r.s.toString(16))}))}catch(t){return Promise.reject(t)}}}function ws(t){return"object"==typeof t&&"r"in t&&"s"in t}function gs(t){return function(e,r){try{return Promise.resolve(r(e)).then((function(e){if(ws(e))return Zo(e,t);if(t&&void 0===Yo(e).recoveryParam)throw new Error("not_supported: ES256K-R not supported when signer doesn't provide a recovery param");return e}))}catch(t){return Promise.reject(t)}}}function bs(){return function(t,e){try{return Promise.resolve(e(t)).then((function(t){if(ws(t))throw new Error("invalid_config: expected a signer function that returns a string instead of signature object");return t}))}catch(t){return Promise.reject(t)}}}const ms={ES256:function(t,e){try{return Promise.resolve(e(t)).then((function(t){return ws(t)?Zo(t):t}))}catch(t){return Promise.reject(t)}},ES256K:gs(),"ES256K-R":gs(!0),Ed25519:bs(),EdDSA:bs()};function vs(t,e){if(e){const r=e.split(":");switch(r[0]){case"bip122":r[r.length-1]=function(t,e){const r=Mo(Fo(e).slice(0,1)),n=qo(t),i=r+Mo(Xi(is(n))),o=is(qo(i));return s=qo(i+Mo(is(o)).substring(0,8)),Vo.toString(s,"base58btc");var s}(t,r[r.length-1]);break;case"cosmos":r[r.length-1]=function(t,e){const r=Do.ProjectivePoint.fromHex(t).toRawBytes(),n=Xi(is(r)),i=Ko.gW.toWords(n);return Ko.gW.encode(e,i).replace(e,"")}(t,r[1]);break;case"eip155":r[r.length-1]=ss(t);break;default:return!1}return r.join(":").toLowerCase()===e.toLowerCase()}return!1}function Es(t,e=!1){const r=zo(t);if(r.length!==(e?65:64))throw new Error("wrong signature length");return{compact:r.slice(0,64),recovery:r[64]}}function xs(t){if(t.publicKeyBase58)return Fo(t.publicKeyBase58);if(t.publicKeyBase64)return zo(t.publicKeyBase64);if(t.publicKeyHex)return qo(t.publicKeyHex);if(t.publicKeyJwk&&"secp256k1"===t.publicKeyJwk.crv&&t.publicKeyJwk.x&&t.publicKeyJwk.y)return Do.ProjectivePoint.fromAffine({x:Go(zo(t.publicKeyJwk.x)),y:Go(zo(t.publicKeyJwk.y))}).toRawBytes(!1);if(t.publicKeyJwk&&"P-256"===t.publicKeyJwk.crv&&t.publicKeyJwk.x&&t.publicKeyJwk.y)return Oo.ProjectivePoint.fromAffine({x:Go(zo(t.publicKeyJwk.x)),y:Go(zo(t.publicKeyJwk.y))}).toRawBytes(!1);if(t.publicKeyJwk&&"OKP"===t.publicKeyJwk.kty&&["Ed25519","X25519"].includes(t.publicKeyJwk.crv??"")&&t.publicKeyJwk.x)return zo(t.publicKeyJwk.x);if(t.publicKeyMultibase){const{base16:e,base58btc:r,base64:n,base64url:i}=Er;return e.decoder.or(r.decoder.or(n.decoder.or(i.decoder))).decode(t.publicKeyMultibase)}return new Uint8Array}function As(t,e,r){const n=[];if(e.length>86)n.push(Es(e,!0));else{const t=Es(e,!1);n.push({...t,recovery:0}),n.push({...t,recovery:1})}const i=is(t),o=t=>{const e=Do.Signature.fromCompact(t.compact).addRecoveryBit(t.recovery||0).recoverPublicKey(i),n=ss(e.toHex(!1)).toLowerCase(),o=e.toHex(!1),s=e.toHex(!0);return r.find((t=>{const e=Mo(xs(t));return e===o||e===s||t.ethereumAddress?.toLowerCase()===n||t.blockchainAccountId?.split("@eip155")?.[0].toLowerCase()===n||vs(o,t.blockchainAccountId)}))};for(const t of n){const e=o(t);if(e)return e}throw new Error("invalid_signature: Signature invalid for JWT")}function _s(t,e,r){const n=Xo(t),i=zo(e),o=r.find((t=>Bi.verify(i,n,xs(t))));if(!o)throw new Error("invalid_signature: Signature invalid for JWT");return o}const Bs={ES256:function(t,e,r){const n=is(t),i=Oo.Signature.fromCompact(Es(e).compact),o=r.filter((t=>!t.ethereumAddress&&!t.blockchainAccountId)).find((t=>{try{const e=xs(t);return Oo.verify(i,n,e)}catch(t){return!1}}));if(!o)throw new Error("invalid_signature: Signature invalid for JWT");return o},ES256K:function(t,e,r){const n=is(t),i=Do.Signature.fromCompact(zo(e)).normalizeS(),o=r.filter((t=>!t.ethereumAddress&&!t.blockchainAccountId)),s=r.filter((t=>t.ethereumAddress||t.blockchainAccountId));let a=o.find((t=>{try{const e=xs(t);return Do.verify(i,n,e)}catch(t){return!1}}));if(!a&&s.length>0&&(a=As(t,e,s)),!a)throw new Error("invalid_signature: Signature invalid for JWT");return a},"ES256K-R":As,Ed25519:_s,EdDSA:_s};function Is(t){const e=Bs[t];if(!e)throw new Error(`not_supported: Unsupported algorithm ${t}`);return e}Is.toSignatureObject=function(t,e=!1){const r=zo(t);if(r.length!==(e?65:64))throw new Error("wrong signature length");const n={r:Mo(r.slice(0,32)),s:Mo(r.slice(32,64))};return e&&(n.recoveryParam=r[64]),n};const Ss={INVALID_JWT:"invalid_jwt",INVALID_AUDIENCE:"invalid_config",INVALID_SIGNATURE:"invalid_signature",NO_SUITABLE_KEYS:"no_suitable_keys",NOT_SUPPORTED:"not_supported",RESOLVER_ERROR:"resolver_error"};function Us(t,e){try{var r=t()}catch(t){return e(t)}return r&&r.then?r.then(void 0,e):r}const Ps="undefined"!=typeof Symbol?Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")):"@@iterator";function Cs(t,e,r){if(!t.s){if(r instanceof Ls){if(!r.s)return void(r.o=Cs.bind(null,t,e));1&e&&(e=r.s),r=r.v}if(r&&r.then)return void r.then(Cs.bind(null,t,e),Cs.bind(null,t,2));t.s=e,t.v=r;const n=t.o;n&&n(t)}}const Ls=function(){function t(){}return t.prototype.then=function(e,r){const n=new t,i=this.s;if(i){const t=1&i?e:r;if(t){try{Cs(n,1,t(this.v))}catch(t){Cs(n,2,t)}return n}return this}return this.o=function(t){try{const i=t.v;1&t.s?Cs(n,1,e?e(i):i):r?Cs(n,1,r(i)):Cs(n,2,i)}catch(t){Cs(n,2,t)}},n},t}();function Ds(t){return t instanceof Ls&&1&t.s}const ks=function(t,{header:e,payload:r,signature:n,data:i},o,s){try{if(o.conditionWeightedThreshold)return function(t,{header:e,payload:r,data:n,signature:i},o,s){try{let c;function a(t){if(c)return t;throw new Error(`${Ss.INVALID_SIGNATURE}: condition for authenticator ${o.id} is not met.`)}if(!o.conditionWeightedThreshold||!o.threshold)throw new Error("Expected conditionWeightedThreshold and threshold");const h=[],u=o.threshold;let f=0;const d=function(t,e,r){if("function"==typeof t[Ps]){var n,i,o,s=t[Ps]();if(function t(a){try{for(;!((n=s.next()).done||r&&r());)if((a=e(n.value))&&a.then){if(!Ds(a))return void a.then(t,o||(o=Cs.bind(null,i=new Ls,2)));a=a.v}i?Cs(i,1,a):i=a}catch(t){Cs(i||(i=new Ls),2,t)}}(),s.return){var a=function(t){try{n.done||s.return()}catch(t){}return t};if(i&&i.then)return i.then(a,(function(t){throw a(t)}));a()}return i}if(!("length"in t))throw new TypeError("Object is not iterable");for(var c=[],h=0;h<t.length;h++)c.push(t[h]);return function(t,e,r){var n,i,o=-1;return function s(a){try{for(;++o<t.length&&(!r||!r());)if((a=e(o))&&a.then){if(!Ds(a))return void a.then(s,i||(i=Cs.bind(null,n=new Ls,2)));a=a.v}n?Cs(n,1,a):n=a}catch(t){Cs(n||(n=new Ls),2,t)}}(),n}(c,(function(t){return e(c[t])}),r)}(o.conditionWeightedThreshold,(function(a){function d(t){return c?t:p&&!h.includes(p.id)&&(h.push(p.id),f+=a.weight,f>=u)?(c=1,o):void 0}const l=a.condition;let p;const y=Us((function(){if(l.type===Ts){if(!s.didAuthenticator)throw new Error("Expected didAuthenticator");const e={...s,didAuthenticator:{didResolutionResult:s.didAuthenticator?.didResolutionResult,authenticators:[l],issuer:l.id}};return Promise.resolve(js(t,e)).then((function({verified:t}){t&&(p=l)}))}return Promise.resolve(ta({header:e,payload:r,data:n,signature:i},l)).then((function(t){p=t}))}),(function(t){if(!t.message.startsWith(Ss.INVALID_SIGNATURE))throw t}));return y&&y.then?y.then(d):d(y)}),(function(){return c}));return Promise.resolve(d&&d.then?d.then(a):a(d))}catch(l){return Promise.reject(l)}}(t,{header:e,payload:r,data:i,signature:n},o,s);if(o.conditionDelegated)return function(t,{header:e,payload:r,data:n,signature:i},o,s){try{if(!o.conditionDelegated)throw new Error("Expected conditionDelegated");if(!s.resolver)throw new Error("Expected resolver");let a;const c=o.conditionDelegated;return Promise.resolve(Ks(s.resolver,e.alg,c,s.proofPurpose)).then((function(h){function u(t){if(a)return o;throw new Error(`${Ss.INVALID_SIGNATURE}: condition for authenticator ${o.id} is not met.`)}const f=h.didResolutionResult;if(!f?.didDocument)throw new Error(`${Ss.RESOLVER_ERROR}: Could not resolve delegated DID ${c}.`);const d=h.authenticators.find((t=>t.id===c));if(!d)throw new Error(`${Ss.NO_SUITABLE_KEYS}: Could not find delegated authenticator ${c} in it's DID Document`);const l=d.type===Ts?Promise.resolve(js(t,{...s,didAuthenticator:{didResolutionResult:f,authenticators:[d],issuer:d.id}})).then((function({verified:t}){t&&(a=d)})):Us((function(){return Promise.resolve(ta({header:e,payload:r,data:n,signature:i},d)).then((function(t){a=t}))}),(function(t){if(!t.message.startsWith("invalid_signature:"))throw t}));return l&&l.then?l.then(u):u()}))}catch(t){return Promise.reject(t)}}(t,{header:e,payload:r,data:i,signature:n},o,s);throw new Error(`${Ss.INVALID_JWT}: conditional proof type did not find condition for authenticator ${o.id}.`)}catch(t){return Promise.reject(t)}},Os=function(t,{header:e,payload:r,signature:n,data:i},o,s){try{return o.type===Ts?ks(t,{payload:r,header:e,signature:n,data:i},o,s):Promise.resolve(ta({header:e,payload:r,data:i,signature:n},[o]))}catch(t){return Promise.reject(t)}},Ts="ConditionalProof2022";function Ns(t,e,r){if(!t.s){if(r instanceof Rs){if(!r.s)return void(r.o=Ns.bind(null,t,e));1&e&&(e=r.s),r=r.v}if(r&&r.then)return void r.then(Ns.bind(null,t,e),Ns.bind(null,t,2));t.s=e,t.v=r;const n=t.o;n&&n(t)}}const Rs=function(){function t(){}return t.prototype.then=function(e,r){const n=new t,i=this.s;if(i){const t=1&i?e:r;if(t){try{Ns(n,1,t(this.v))}catch(t){Ns(n,2,t)}return n}return this}return this.o=function(t){try{const i=t.v;1&t.s?Ns(n,1,e?e(i):i):r?Ns(n,1,r(i)):Ns(n,2,i)}catch(t){Ns(n,2,t)}},n},t}();function $s(t){return t instanceof Rs&&1&t.s}const Ks=function(t,e,r,n){try{const i=Fs[e];if(!i||0===i.length)throw new Error(`${Ss.NOT_SUPPORTED}: No supported signature types for algorithm ${e}`);let o;return Promise.resolve(t.resolve(r,{accept:Gs})).then((function(t){if(o=-1===Object.getOwnPropertyNames(t).indexOf("didDocument")?{didDocument:t,didDocumentMetadata:{},didResolutionMetadata:{contentType:Gs}}:t,o.didResolutionMetadata?.error||null==o.didDocument){const{error:t,message:e}=o.didResolutionMetadata;throw new Error(`${Ss.RESOLVER_ERROR}: Unable to resolve DID document for ${r}: ${t}, ${e||""}`)}const s=(t,e)=>{const r=t.filter((({id:t})=>e===t));return r.length>0?r[0]:null};let a=[...o?.didDocument?.verificationMethod||[],...o?.didDocument?.publicKey||[]];"string"==typeof n&&(n.startsWith("assertion")&&!Object.getOwnPropertyNames(o?.didDocument).includes("assertionMethod")&&(o.didDocument={...o.didDocument},o.didDocument.assertionMethod=[...a.map((t=>t.id))]),a=(o.didDocument[n]||[]).map((t=>"string"==typeof t?s(a,t):"string"==typeof t.publicKey?s(a,t.publicKey):t)).filter((t=>null!=t)));const c=a.filter((({type:t})=>i.find((e=>e===t))));if("string"==typeof n&&(!c||0===c.length))throw new Error(`${Ss.NO_SUITABLE_KEYS}: DID document for ${r} does not have public keys suitable for ${e} with ${n} purpose`);if(!c||0===c.length)throw new Error(`${Ss.NO_SUITABLE_KEYS}: DID document for ${r} does not have public keys for ${e}`);return{authenticators:c,issuer:r,didResolutionResult:o}}))}catch(t){return Promise.reject(t)}},js=function(t,e={resolver:void 0,auth:void 0,audience:void 0,callbackUrl:void 0,skewTime:void 0,proofPurpose:void 0,policies:{},didAuthenticator:void 0}){try{function r(){function r(r){if(d){const r="number"==typeof e.policies?.now?e.policies.now:Math.floor(Date.now()/1e3),i=void 0!==e.skewTime&&e.skewTime>=0?e.skewTime:Zs,o=r+i;if(!1!==e.policies?.nbf&&n.nbf){if(n.nbf>o)throw new Error(`${Ss.INVALID_JWT}: JWT not valid before nbf: ${n.nbf}`)}else if(!1!==e.policies?.iat&&n.iat&&n.iat>o)throw new Error(`${Ss.INVALID_JWT}: JWT not valid yet (issued in the future) iat: ${n.iat}`);if(!1!==e.policies?.exp&&n.exp&&n.exp<=r-i)throw new Error(`${Ss.INVALID_JWT}: JWT has expired: exp: ${n.exp} < now: ${r}`);if(!1!==e.policies?.aud&&n.aud){if(!e.audience&&!e.callbackUrl)throw new Error(`${Ss.INVALID_AUDIENCE}: JWT audience is required but your app address has not been configured`);if(void 0===(Array.isArray(n.aud)?n.aud:[n.aud]).find((t=>e.audience===t||e.callbackUrl===t)))throw new Error(`${Ss.INVALID_AUDIENCE}: JWT audience does not match your DID or callback url`)}return{verified:!0,payload:n,didResolutionResult:f,issuer:u,signer:d,jwt:t,policies:e.policies}}throw new Error(`${Ss.INVALID_SIGNATURE}: JWT not valid. issuer DID document does not contain a verificationMethod that matches the signature.`)}const{did:a}=function(t){if(""===t||!t)return null;const e=t.match($o);if(e){const r={did:`did:${e[1]}:${e[2]}`,method:e[1],id:e[2],didUrl:t};if(e[4]){const t=e[4].slice(1).split(";");r.params={};for(const e of t){const t=e.split("=");r.params[t[0]]=t[1]}}return e[6]&&(r.path=e[6]),e[7]&&(r.query=e[7].slice(1)),e[8]&&(r.fragment=e[8].slice(1)),r}return null}(c);let d=null;const l=function(){if(a!==c){const r=h.find((t=>t.id===c));if(!r)throw new Error(`${Ss.INVALID_JWT}: No authenticator found for did URL ${c}`);return Promise.resolve(Os(t,{payload:n,header:i,signature:o,data:s},r,e)).then((function(t){d=t}))}{let r=0;return function(t,e,r){for(var n;;){var i=t();if($s(i)&&(i=i.v),!i)return s;if(i.then){n=0;break}var o,s=r();if(s&&s.then){if(!$s(s)){n=1;break}s=s.s}}var a=new Rs,c=Ns.bind(null,a,2);return(0===n?i.then(u):1===n?s.then(h):o.then(f)).then(void 0,c),a;function h(e){s=e;do{if(!(i=t())||$s(i)&&!i.v)return void Ns(a,1,s);if(i.then)return void i.then(u).then(void 0,c);$s(s=r())&&(s=s.v)}while(!s||!s.then);s.then(h).then(void 0,c)}function u(t){t?(s=r())&&s.then?s.then(h).then(void 0,c):h(s):Ns(a,1,s)}function f(){(i=t())?i.then?i.then(u).then(void 0,c):u(i):Ns(a,1,s)}}((function(){return!d&&r<h.length}),0,(function(){function a(t){r++}const c=h[r],u=function(r,a){try{var h=Promise.resolve(Os(t,{payload:n,header:i,signature:o,data:s},c,e)).then((function(t){d=t}))}catch(t){return a(t)}return h&&h.then?h.then(void 0,a):h}(0,(function(t){if(!t.message.includes(Ss.INVALID_SIGNATURE)||r===h.length-1)throw t}));return u&&u.then?u.then(a):a()}))}}();return l&&l.then?l.then(r):r()}if(!e.resolver)throw new Error("missing_resolver: No DID resolver has been configured");const{payload:n,header:i,signature:o,data:s}=Qs(t,!1),a=Object.prototype.hasOwnProperty.call(e,"auth")?e.auth?"authentication":void 0:e.proofPurpose;let c,h,u,f;if(!n.iss&&!n.client_id)throw new Error(`${Ss.INVALID_JWT}: JWT iss or client_id are required`);if(e.didAuthenticator)c=e.didAuthenticator.issuer;else if(n.iss===qs||n.iss===Ws){if(!n.sub)throw new Error(`${Ss.INVALID_JWT}: JWT sub is required`);c=void 0===n.sub_jwk?n.sub:(i.kid||"").split("#")[0]}else if(n.iss===Js){if(!n.did)throw new Error(`${Ss.INVALID_JWT}: JWT did is required`);c=n.did}else if(!n.iss&&"openid"===n.scope&&n.redirect_uri){if(!n.client_id)throw new Error(`${Ss.INVALID_JWT}: JWT client_id is required`);c=n.client_id}else c=n.iss;if(!c)throw new Error(`${Ss.INVALID_JWT}: No DID has been found in the JWT`);const d=function(){if(!e.didAuthenticator)return Promise.resolve(Ks(e.resolver,i.alg,c,a)).then((function(t){({didResolutionResult:f,authenticators:h,issuer:u}=t),e.didAuthenticator={didResolutionResult:f,authenticators:h,issuer:u}}));({didResolutionResult:f,authenticators:h,issuer:u}=e.didAuthenticator)}();return Promise.resolve(d&&d.then?d.then(r):r())}catch(l){return Promise.reject(l)}},Vs=function(t,{expiresIn:e,canonicalize:r},n){try{if(0===n.length)throw new Error("invalid_argument: must provide one or more issuers");let h=t,u="";const f=(i=n,o=function(t){const i=n[t],o={typ:"JWT",alg:i.alg};return 0!==t&&(o.cty="JWT"),Promise.resolve(Hs(h,{...i,canonicalize:r,expiresIn:e},o)).then((function(t){u=t,h={jwt:u}}))},c=-1,function t(e){try{for(;++c<i.length;)if((e=o(c))&&e.then){if(!$s(e))return void e.then(t,a||(a=Ns.bind(null,s=new Rs,2)));e=e.v}s?Ns(s,1,e):s=e}catch(t){Ns(s||(s=new Rs),2,t)}}(),s);return Promise.resolve(f&&f.then?f.then((function(){return u})):u)}catch(t){return Promise.reject(t)}var i,o,s,a,c},Hs=function(t,{issuer:e,signer:r,alg:n,expiresIn:i,canonicalize:o},s={}){try{if(!r)throw new Error("missing_signer: No Signer functionality has been configured");if(!e)throw new Error("missing_issuer: No issuing DID has been configured");s.typ||(s.typ="JWT"),s.alg||(s.alg=n);const a={iat:Math.floor(Date.now()/1e3),exp:void 0};if(i){if("number"!=typeof i)throw new Error("invalid_argument: JWT expiresIn is not a number");a.exp=(t.nbf||a.iat)+Math.floor(i)}const c={...a,...t,iss:e};return zs(c,r,s,{canonicalize:o})}catch(t){return Promise.reject(t)}},zs=function(t,e,r={},n={}){try{r.alg||(r.alg=Ms);const i="string"==typeof t?t:Xs(t,n.canonicalize),o=[Xs(r,n.canonicalize),i].join("."),s=function(t){const e=ms[t];if(!e)throw new Error(`not_supported: Unsupported algorithm ${t}`);return e}(r.alg);return Promise.resolve(s(o,e)).then((function(t){return[o,t].join(".")}))}catch(t){return Promise.reject(t)}},Fs={ES256:["JsonWebKey2020"],ES256K:["EcdsaSecp256k1VerificationKey2019","EcdsaSecp256k1RecoveryMethod2020","Secp256k1VerificationKey2018","Secp256k1SignatureVerificationKey2018","EcdsaPublicKeySecp256k1","JsonWebKey2020"],"ES256K-R":["EcdsaSecp256k1VerificationKey2019","EcdsaSecp256k1RecoveryMethod2020","Secp256k1VerificationKey2018","Secp256k1SignatureVerificationKey2018","EcdsaPublicKeySecp256k1","ConditionalProof2022","JsonWebKey2020"],Ed25519:["ED25519SignatureVerification","Ed25519VerificationKey2018","Ed25519VerificationKey2020","JsonWebKey2020"],EdDSA:["ED25519SignatureVerification","Ed25519VerificationKey2018","Ed25519VerificationKey2020","JsonWebKey2020"]},qs="https://self-issued.me/v2",Ws="https://self-issued.me/v2/openid-vc",Js="https://self-issued.me",Ms="ES256K",Gs="application/did+json";function Xs(t,e=!1){return Wo(e?To(t):JSON.stringify(t))}const Zs=300;function Ys(t){const e=t.match(/^([a-zA-Z0-9_-]+)\.([a-zA-Z0-9_-]+)\.([a-zA-Z0-9_-]+)$/);if(e)return{header:JSON.parse(Jo(e[1])),payload:e[2],signature:e[3],data:`${e[1]}.${e[2]}`};throw new Error("invalid_argument: Incorrect format JWS")}function Qs(t,e=!0){if(!t)throw new Error("invalid_argument: no JWT passed into decodeJWT");try{const r=Ys(t),n=Object.assign(r,{payload:JSON.parse(Jo(r.payload))}),i=n.payload.iss;if("JWT"===n.header.cty&&e){const t=Qs(n.payload.jwt);if(t.payload.iss!==i)throw new Error(`${Ss.INVALID_JWT}: multiple issuers`);return t}return n}catch(t){throw new Error("invalid_argument: Incorrect format JWT")}}function ta({header:t,payload:e,data:r,signature:n},i){Array.isArray(i)||(i=[i]);const o=e.iss;let s=!0;do{if(o!==e.iss)throw new Error(`${Ss.INVALID_JWT}: multiple issuers`);try{return Is(t.alg)(r,n,i)}catch(t){if(!t.message.startsWith(Ss.INVALID_SIGNATURE))throw t}"JWT"!==t.cty?s=!1:({payload:e,header:t,signature:n,data:r}=Qs(e.jwt,!1))}while(s);throw new Error(`${Ss.INVALID_SIGNATURE}: no matching public key found`)}function ea(t,e){return function({header:t,data:e,signature:r},n){return Array.isArray(n)||(n=[n]),Is(t.alg)(e,r,n)}(Ys(t),e)}const ra="undefined"!=typeof Symbol?Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")):"@@iterator";function na(t,e,r){if(!t.s){if(r instanceof ia){if(!r.s)return void(r.o=na.bind(null,t,e));1&e&&(e=r.s),r=r.v}if(r&&r.then)return void r.then(na.bind(null,t,e),na.bind(null,t,2));t.s=e,t.v=r;const n=t.o;n&&n(t)}}const ia=function(){function t(){}return t.prototype.then=function(e,r){const n=new t,i=this.s;if(i){const t=1&i?e:r;if(t){try{na(n,1,t(this.v))}catch(t){na(n,2,t)}return n}return this}return this.o=function(t){try{const i=t.v;1&t.s?na(n,1,e?e(i):i):r?na(n,1,r(i)):na(n,2,i)}catch(t){na(n,2,t)}},n},t}();function oa(t){return t instanceof ia&&1&t.s}function sa({ciphertext:t,tag:e,iv:r,protectedHeader:n,recipient:i},o){const s={protected:n,iv:Ho(r??new Uint8Array(0)),ciphertext:Ho(t),tag:Ho(e??new Uint8Array(0))};return o&&(s.aad=Ho(o)),i&&(s.recipients=[i]),s}const aa=function(t,e){try{function r(t){if(null===s)throw new Error("failure: Failed to decrypt");return s}!function(t){if(!(t.protected&&t.iv&&t.ciphertext&&t.tag))throw new Error("bad_jwe: missing properties");t.recipients&&t.recipients.map((t=>{if(!t.header||!t.encrypted_key)throw new Error("bad_jwe: malformed recipients")}))}(t);const n=JSON.parse(Jo(t.protected));if(n.enc!==e.enc)throw new Error(`not_supported: Decrypter does not supported: '${n.enc}'`);const i=Qo(t.ciphertext,t.tag),o=re(t.aad?`${t.protected}.${t.aad}`:t.protected,"utf-8");let s=null;const a="dir"===n.alg&&"dir"===e.alg?Promise.resolve(e.decrypt(i,zo(t.iv),o)).then((function(t){s=t})):function(){if(t.recipients&&0!==t.recipients.length){let r=0;return function(t,e,r){for(var n;;){var i=t();if(oa(i)&&(i=i.v),!i)return o;if(i.then){n=0;break}var o=r();if(o&&o.then){if(!oa(o)){n=1;break}o=o.s}if(e){var s=e();if(s&&s.then&&!oa(s)){n=2;break}}}var a=new ia,c=na.bind(null,a,2);return(0===n?i.then(u):1===n?o.then(h):s.then(f)).then(void 0,c),a;function h(n){o=n;do{if(e&&(s=e())&&s.then&&!oa(s))return void s.then(f).then(void 0,c);if(!(i=t())||oa(i)&&!i.v)return void na(a,1,o);if(i.then)return void i.then(u).then(void 0,c);oa(o=r())&&(o=o.v)}while(!o||!o.then);o.then(h).then(void 0,c)}function u(t){t?(o=r())&&o.then?o.then(h).then(void 0,c):h(o):na(a,1,o)}function f(){(i=t())?i.then?i.then(u).then(void 0,c):u(i):na(a,1,o)}}((function(){return!s&&r<t.recipients.length}),(function(){return r++}),(function(){const a=t.recipients[r];Object.assign(a.header,n);const c=function(){if(a.header.alg===e.alg)return Promise.resolve(e.decrypt(i,zo(t.iv),o,a)).then((function(t){s=t}))}();if(c&&c.then)return c.then((function(){}))}))}throw new Error("bad_jwe: missing recipients")}();return Promise.resolve(a&&a.then?a.then(r):r())}catch(c){return Promise.reject(c)}},ca=function(t,e,r={},n,i=!1){try{if("dir"===e[0].alg){if(e.length>1)throw new Error('not_supported: Can only do "dir" encryption to one key.');return Promise.resolve(e[0].encrypt(t,r,n)).then((function(t){return sa(t,n)}))}{const o=e[0].enc;if(!e.reduce(((t,e)=>t&&e.enc===o),!0))throw new Error("invalid_argument: Incompatible encrypters passed");let s,a,c;if(i){c=e[0].genEpk?.();const t=e[0].alg;r={...r,alg:t,epk:c?.publicKeyJWK}}const h=function(t,e,r){if("function"==typeof t[ra]){var n,i,o,s=t[ra]();if(function t(a){try{for(;!((n=s.next()).done||r&&r());)if((a=e(n.value))&&a.then){if(!oa(a))return void a.then(t,o||(o=na.bind(null,i=new ia,2)));a=a.v}i?na(i,1,a):i=a}catch(t){na(i||(i=new ia),2,t)}}(),s.return){var a=function(t){try{n.done||s.return()}catch(t){}return t};if(i&&i.then)return i.then(a,(function(t){throw a(t)}));a()}return i}if(!("length"in t))throw new TypeError("Object is not iterable");for(var c=[],h=0;h<t.length;h++)c.push(t[h]);return function(t,e,r){var n,i,o=-1;return function s(a){try{for(;++o<t.length&&(!r||!r());)if((a=e(o))&&a.then){if(!oa(a))return void a.then(s,i||(i=na.bind(null,n=new ia,2)));a=a.v}n?na(n,1,a):n=a}catch(t){na(n||(n=new ia),2,t)}}(),n}(c,(function(t){return e(c[t])}),r)}(e,(function(e){const i=s?Promise.resolve(e.encryptCek?.(s,c)).then((function(t){t&&a?.recipients?.push(t)})):Promise.resolve(e.encrypt(t,r,n,c)).then((function(t){s=t.cek,a=sa(t,n)}));if(i&&i.then)return i.then((function(){}))}));return Promise.resolve(h&&h.then?h.then((function(){return a})):a)}}catch(t){return Promise.reject(t)}};function ha(t){const e=new jo.NV(t);return(t,r)=>{const n=Or(e.nonceLength),i=e.seal(n,t,r);return{ciphertext:i.subarray(0,i.length-e.tagLength),tag:i.subarray(i.length-e.tagLength),iv:n}}}function ua(t){const e=ha(t),r="XC20P";return{alg:"dir",enc:r,encrypt:function(t,n={},i){try{const o=Wo(JSON.stringify(Object.assign({alg:"dir"},n,{enc:r}))),s=re(i?`${o}.${Ho(i)}`:o,"utf-8");return Promise.resolve({...e(t,s),protectedHeader:o})}catch(t){return Promise.reject(t)}}}}function fa(t){const e=new jo.NV(t);return{alg:"dir",enc:"XC20P",decrypt:function(t,r,n){try{return Promise.resolve(e.open(r,t,n))}catch(t){return Promise.reject(t)}}}}const da=function(t,e,r,n,i,o){try{const e="X25519",n=256,s=o?rs(o.secretKey):es(),a={kty:"OKP",crv:e,x:Ho(s.publicKey)},c=hs(Si.getSharedSecret(s.secretKey,t),n,r,void 0,zo(i??""));return Promise.resolve({epk:a,kek:c})}catch(t){return Promise.reject(t)}},la=function(t,e,r){try{function n(){let e,n;return t.header.apu&&(e=zo(t.header.apu)),t.header.apv&&(n=zo(t.header.apv)),hs(c,o,r,e,n)}const i="X25519",o=256,s=t.header;if(s.epk?.crv!==i||void 0===s.epk.x)return Promise.resolve(null);const a=zo(s.epk.x);let c;const h=function(){if(!(e instanceof Uint8Array))return Promise.resolve(e(a)).then((function(t){c=t}));c=Si.getSharedSecret(e,a)}();return Promise.resolve(h&&h.then?h.then(n):n())}catch(u){return Promise.reject(u)}},pa=function(t,e,r,n,i,o){try{function s(){const t=new Uint8Array(f.length+d.length);t.set(f),t.set(d,f.length);let e=new Uint8Array(0),o=new Uint8Array(0);n&&(e=zo(n)),i&&(o=zo(i));const s=hs(t,c,r,e,o);return{epk:u,kek:s}}const a="X25519",c=256,h=o?rs(o.secretKey):es(),u={kty:"OKP",crv:a,x:Ho(h.publicKey)},f=Si.getSharedSecret(h.secretKey,t);let d;const l=function(){if(!(e instanceof Uint8Array))return Promise.resolve(e(t)).then((function(t){d=t}));d=Si.getSharedSecret(e,t)}();return Promise.resolve(l&&l.then?l.then(s):s())}catch(p){return Promise.reject(p)}},ya=function(t,e,r,n){try{function i(){const e=new Uint8Array(h.length+u.length);let r,i;return e.set(h),e.set(u,h.length),t.header.apu&&(r=zo(t.header.apu)),t.header.apv&&(i=zo(t.header.apv)),hs(e,s,n,r,i)}const o="X25519",s=256,a=t.header;if(a.epk?.crv!==o||void 0===a.epk.x)return Promise.resolve(null);const c=zo(a.epk.x);let h,u;const f=function(){if(!(e instanceof Uint8Array))return Promise.resolve(e(c)).then((function(t){return h=t,Promise.resolve(e(r)).then((function(t){u=t}))}));h=Si.getSharedSecret(e,c),u=Si.getSharedSecret(e,r)}();return Promise.resolve(f&&f.then?f.then(i):i())}catch(d){return Promise.reject(d)}};function wa(t){if(32!==t.length)throw new Error("invalid_argument: incorrect secret key length for X25519");return function(e){try{if(32!==e.length)throw new Error("invalid_argument: incorrect publicKey key length for X25519");return Promise.resolve(Si.getSharedSecret(t,e))}catch(t){return Promise.reject(t)}}}function ga(t,e,r={},n,i,o){const s=function(o,s){try{return Promise.resolve(n.createKek(t,e,`${n.alg}+${i.alg}`,r.apu,r.apv,s)).then((function({epk:t,kek:e}){return Promise.resolve(i.from(e).wrap(o)).then((function(e){const o={encrypted_key:Ho(e.ciphertext),header:{}};return e.iv&&(o.header.iv=Ho(e.iv)),e.tag&&(o.header.tag=Ho(e.tag)),r.kid&&(o.header.kid=r.kid),r.apu&&(o.header.apu=r.apu),r.apv&&(o.header.apv=r.apv),s||(o.header.alg=`${n.alg}+${i.alg}`,o.header.epk=t),o}))}))}catch(t){return Promise.reject(t)}};return{alg:i.alg,enc:o.enc,encrypt:function(t,e={},r,a){try{Object.assign(e,{alg:void 0});const c=Or(32);return Promise.resolve(s(c,a)).then((function(s){return a&&(e.alg=`${n.alg}+${i.alg}`,e.epk=a.publicKeyJWK),Promise.resolve(o.from(c).encrypt(t,e,r)).then((function(t){return{...t,recipient:s,cek:c}}))}))}catch(t){return Promise.reject(t)}},encryptCek:s,genEpk:ns}}const ba=function(t,e){try{const r=function(t,n=[]){try{return Promise.resolve(e.resolve(t)).then((function({didResolutionMetadata:e,didDocument:i}){function o(){const e=i.keyAgreement?.map((t=>"string"==typeof t?[...i.publicKey||[],...i.verificationMethod||[]].find((e=>e.id===t)):t))?.filter((t=>void 0!==t)),r=e?.filter((t=>"X25519KeyAgreementKey2019"===t.type||"X25519KeyAgreementKey2020"===t.type))||[];if(!r.length&&!s.length)throw new Error(`no_suitable_keys: Could not find x25519 key for ${t}`);return r.map((t=>Ba(xs(t),t.id))).concat(...s)}if(n.push(t),e?.error||null==i)throw new Error(`resolver_error: Could not resolve ${t}: ${e.error}, ${e.message}`);let s=[];if(!i.controller&&!i.keyAgreement)throw new Error(`no_suitable_keys: Could not find x25519 key for ${t}`);const a=function(){if(i.controller){let t=Array.isArray(i.controller)?i.controller:[i.controller];t=t.filter((t=>!n.includes(t)));const e=t.map((t=>r(t,n).catch((()=>[]))));return Promise.resolve(Promise.all(e)).then((function(t){s=[].concat(...t)}))}}();return a&&a.then?a.then(o):o()}))}catch(t){return Promise.reject(t)}},n=t.map((t=>r(t)));return Promise.resolve(Promise.all(n)).then((function(t){return[].concat(...t)}))}catch(t){return Promise.reject(t)}};function ma(t,e,r={}){return Sa(t,e,r)}function va(t,e={}){return Ia(t,e)}function Ea(t,e){return Ca(t,e)}function xa(t){return Pa(t)}function Aa(t){if(!(t&&t.epk&&t.iv&&t.tag))throw new Error("bad_jwe: malformed header");return t}const _a={from:t=>({wrap:function(e){try{return Promise.resolve(ha(t)(e))}catch(t){return Promise.reject(t)}}}),alg:"XC20PKW"};function Ba(t,e,r){return Ia(t,{kid:e,apv:r})}function Ia(t,e={}){return ga(t,void 0,e,{createKek:da,alg:"ECDH-ES"},_a,{from:t=>ua(t),enc:"XC20P"})}function Sa(t,e,r={}){return ga(t,e,r,{createKek:pa,alg:"ECDH-1PU"},_a,{from:t=>ua(t),enc:"XC20P"})}function Ua(t){return Pa(t)}function Pa(t){const e="ECDH-ES+XC20PKW";return{alg:e,enc:"XC20P",decrypt:function(r,n,i,o){try{const s=Aa(o.header);return Promise.resolve(la(o,t,e)).then((function(t){if(!t)return null;const e=Qo(o.encrypted_key,s.tag);return Promise.resolve(fa(t).decrypt(e,zo(s.iv))).then((function(t){return null===t?null:fa(t).decrypt(r,n,i)}))}))}catch(t){return Promise.reject(t)}}}}function Ca(t,e){const r="ECDH-1PU+XC20PKW";return{alg:r,enc:"XC20P",decrypt:function(n,i,o,s){try{const a=Aa(s.header);return Promise.resolve(ya(s,t,e,r)).then((function(t){if(!t)return null;const e=Qo(s.encrypted_key,a.tag);return Promise.resolve(fa(t).decrypt(e,zo(a.iv))).then((function(t){return null===t?null:fa(t).decrypt(n,i,o)}))}))}catch(t){return Promise.reject(t)}}}}})();var i=n._D,o=n.qT,s=n.vo,a=n._J,c=n.Fh,h=n.Qu,u=n.R8,f=n.Ks,d=n.K9,l=n.kr,p=n.Gp,y=n.Qf,w=n._6,g=n.ax,b=n.P9,m=n.aD,v=n.I7,E=n.zO,x=n.pk,A=n.XX,_=n.qK,B=n.yv,I=n.xK,S=n.fq,U=n.xp,P=n.jB,C=n.bK,L=n.nr,D=n.AX,k=n.Mq,O=n.ZW,T=n.PZ,N=n.Y,R=n.Qv,$=n.$1,K=n._I,j=n.UR,V=n.C2;export{i as ES256KSigner,o as ES256Signer,s as EdDSASigner,a as EllipticSigner,c as JWT_ERROR,h as NaclSigner,u as SimpleSigner,f as base58ToBytes,d as base64ToBytes,l as computeX25519Ecdh1PUv3Kek,p as computeX25519EcdhEsKek,y as concatKDF,w as createAnonDecrypter,g as createAnonEncrypter,b as createAuthDecrypter,m as createAuthEncrypter,v as createFullEncrypter,E as createJWE,x as createJWS,A as createJWT,_ as createMultisignatureJWT,B as createX25519ECDH,I as createX25519Ecdh1PUv3Kek,S as createX25519EcdhEsKek,U as decodeJWT,P as decryptJWE,C as genX25519EphemeralKeyPair,L as hexToBytes,D as resolveX25519Encrypters,k as toEthereumAddress,O as verifyJWS,T as verifyJWT,N as x25519Decrypter,R as x25519Encrypter,$ as xc20pAuthDecrypterEcdh1PuV3x25519WithXc20PkwV2,K as xc20pAuthEncrypterEcdh1PuV3x25519WithXc20PkwV2,j as xc20pDirDecrypter,V as xc20pDirEncrypter};